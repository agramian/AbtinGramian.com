(function(c,k){var p=function(c,k,n){var p;return function(){var t=this,B=arguments;p?clearTimeout(p):n&&c.apply(t,B);p=setTimeout(function(){n||c.apply(t,B);p=null},k||100)}};jQuery.fn[k]=function(c){return c?this.bind("resize",p(c)):this.trigger(k)}})(jQuery,"smartresize");var firstNameAnimDur=750,lastNameAnimDur=500,buttonAnimDur=250,buttonHoverDur=100,currentPage,buttonsArray=["homeButtonImg","aboutButtonImg","workButtonImg","resumeButtonImg","contactButtonImg"],homeColor="#FFF",aboutColor="#fedf0b",workColor="#1f63ae",resumeColor="#9966ff",contactColor="#336600",mainContentHeight,isMobileDevice,isWindowsPhone,currentPlatform,isChrome;navigator.userAgent.match(/(Windows Phone)|(IEMobile)|(WPDesktop)/i)?(currentPlatform="Other",isWindowsPhone=isMobileDevice=!0):(-1!=navigator.platform.indexOf("Win")?(currentPlatform="Win",isMobileDevice=!1):-1!=navigator.platform.indexOf("Mac")?(currentPlatform="Mac",isMobileDevice=!1):(currentPlatform="Other",isMobileDevice=!0),isWindowsPhone=!1);isChrome=-1<navigator.userAgent.toLowerCase().indexOf("chrome");function runAnimations(c){currentPage=c;mainContentHeight=$(window).height()-$("#titleBar").height()-$("#navigationBar").height();$("#mainContent").css("height",mainContentHeight+"px");0==currentPage&&$("#drawingDiv").css("height",mainContentHeight+"px");switch(c){case 0:$("#mainContent").css("background-color",homeColor);break;case 1:$("#mainContent").css("background-color",aboutColor);$("#abtinPortrait").css("visibility","visible");break;case 2:$("#mainContent").css("background-color",workColor);break;case 3:$("#mainContent").css("background-color",resumeColor);break;case 4:$("#mainContent").css("background-color",contactColor)}$("#mainContent").css("visibility","visible");0==c?$("#mainContent").hide().delay(firstNameAnimDur+lastNameAnimDur+currentPage*buttonAnimDur).fadeIn(buttonAnimDur,function(){"ontouchstart"in window?document.getElementById("mainContent").addEventListener("touchstart",removeHomeWelcomeMsg):document.getElementById("mainContent").addEventListener("mousemove",removeHomeWelcomeMsg)}):1==c?$("#mainContent").hide().delay(firstNameAnimDur+lastNameAnimDur+currentPage*buttonAnimDur).fadeIn(buttonAnimDur,function(){checkFooter();adjustMainContentHeight()}):2==c?$("#mainContent").hide().delay(firstNameAnimDur+lastNameAnimDur+currentPage*buttonAnimDur).fadeIn(buttonAnimDur,function(){setupGallery()}):3==c?$("#mainContent").hide().delay(firstNameAnimDur+lastNameAnimDur+currentPage*buttonAnimDur).fadeIn(buttonAnimDur,function(){var c=$("#resume").offset().top,p=$("#mainContent").offset().top,r=mainContentHeight-(c-p)-60,m;$.ajax({url:"resume/getResumePath",data:{deviceType:isMobileDevice},success:function(c){m=c;isMobileDevice?$("#resume").html("<center><iframe id='resumeEmbed' src='"+m+"' width='880px' height='"+r+"px'></iframe></center>"):$("#resume").html("<center><object id='resumeEmbed' width='880px' height='"+r+"px' data='"+m+"' #view='FitH' type='application/pdf'> <p>It appears you don't have a PDF plugin for this browser. You can <a href='"+m+"'>click here to download the PDF file.</a></p></object></center>")}})}):4==c?$("#mainContent").hide().delay(firstNameAnimDur+lastNameAnimDur+currentPage*buttonAnimDur).fadeIn(buttonAnimDur,function(){var c=$("#message").offset().top,p=$("#mainContent").offset().top,c=mainContentHeight-(c-p)-115;$("textarea").css("max-height",c+"px");adjustMainContentHeight()}):$("#mainContent").hide().delay(firstNameAnimDur+lastNameAnimDur+currentPage*buttonAnimDur).fadeIn(buttonAnimDur);animateFirstName()}function animateFirstName(){$("#lastName").css({visibility:"hidden",top:"95px",left:"0px"});$("#firstName").css({top:"95px",left:"-361px"});$("#firstName").css({visibility:"visible"});$("#firstName").animate({left:"0px"},firstNameAnimDur,animateLastName)}function animateLastName(){$("#lastName").css({visibility:"visible"});$("#lastName").animate({left:"361px"},lastNameAnimDur,animateNavButtons)}function animateNavButtons(){var c=0;$.each(buttonsArray,function(){$("#"+this).delay(c*buttonAnimDur).css({visibility:"visible",height:"0px",width:"188px","padding-top":"60px"}).animate({height:"60px","padding-top":"0px"},buttonAnimDur,addButtonHoverEffect(this,c));c++});$("#firstName").click(function(){reanimateNames()});$("#lastName").click(function(){reanimateNames()});addNameHoverEffects()}function addButtonHoverEffect(c,k){k!=currentPage&&$("#"+c).hover(function(){$("#"+c).animate({opacity:0.5},buttonHoverDur)},function(){$("#"+c).animate({opacity:1},buttonHoverDur)})}function reanimateNames(){$("#firstName").unbind("hover");$("#lastName").unbind("hover");$("#firstName").css("opacity",1);$("#lastName").css("opacity",1);$("#lastName").css({visibility:"hidden",top:"95px",left:"0px"});$("#firstName").css({top:"95px",left:"-361px"});$("#firstName").animate({left:"0px"},firstNameAnimDur,function(){$("#lastName").css({visibility:"visible"});$("#lastName").animate({left:"361px"},lastNameAnimDur,addNameHoverEffects)})}function addNameHoverEffects(){$("#firstName").hover(function(){$("#firstName").animate({opacity:0.9},200);$("#lastName").animate({opacity:0.9},200)},function(){$("#firstName").animate({opacity:1},200);$("#lastName").animate({opacity:1},200)});$("#lastName").hover(function(){$("#firstName").animate({opacity:0.9},200);$("#lastName").animate({opacity:0.9},200)},function(){$("#firstName").animate({opacity:1},200);$("#lastName").animate({opacity:1},200)})}function adjustMainContentHeight(){2!=currentPage&&3!=currentPage&&(mainContentHeight=mainContentHeight>getDocHeight?$(window).height()-$("#titleBar").height()-$("#navigationBar").height():getDocHeight()-$("#titleBar").height()-$("#navigationBar").height());if(3==currentPage){mainContentHeight=$(window).height()-$("#titleBar").height()-$("#navigationBar").height();var c=$("#resume").offset().top,k=$("#mainContent").offset().top,k=mainContentHeight-(c-k)-60;300>k&&(mainContentHeight+=300-k,k=300);$("#resumeEmbed").attr("height",k+"px")}else 2==currentPage&&(mainContentHeight=$(window).height()-$("#titleBar").height()-$("#navigationBar").height(),mainContentHeight<mainContentGalleryPageHeight&&(mainContentHeight=mainContentGalleryPageHeight));$("#mainContent").css("height",mainContentHeight+"px");0==currentPage?$("#drawingDiv").css("height",mainContentHeight+"px"):4==currentPage&&(c=$("#message").offset().top,k=$("#mainContent").offset().top,k=mainContentHeight-(c-k)-118,$("textarea").css("max-height",k+"px"))}function removeHomeWelcomeMsg(){"ontouchstart"in window?document.getElementById("mainContent").removeEventListener("touchstart",removeHomeWelcomeMsg):document.getElementById("mainContent").removeEventListener("mousemove",removeHomeWelcomeMsg);$("#homeWelcome").remove();startDrawing(0)}$(window).smartresize(function(){adjustMainContentHeight()});function getDocHeight(){var c=document;return Math.max(Math.max(c.body.scrollHeight,c.documentElement.scrollHeight),Math.max(c.body.offsetHeight,c.documentElement.offsetHeight),Math.max(c.body.clientHeight,c.documentElement.clientHeight))}function getDocWidth(){var c=document;return Math.max(Math.max(c.body.scrollWidth,c.documentElement.scrollWidth),Math.max(c.body.offsetWidth,c.documentElement.offsetWidth),Math.max(c.body.clientWidth,c.documentElement.clientWidth))};(function(c){var k,p,r,m=this,n=m.document,J=c(n),t=c(m),B=Array.prototype,fa=!0,S=!1,D=navigator.userAgent.toLowerCase(),ga=m.location.hash.replace(/#\//,""),s=function(){},pa=function(){return!1},q,x=3,E=n.createElement("div"),qa=E.getElementsByTagName("i");do E.innerHTML="\x3c!--[if gt IE "+ ++x+"]><i></i><![endif]--\x3e";while(qa[0]);q=4<x?x:void 0;var v=function(){return{html:n.documentElement,body:n.body,head:n.getElementsByTagName("head")[0],title:n.title}},K=m.parent!==m.self,T,U=[];T=(c.each("data ready thumbnail loadstart loadfinish image play pause progress fullscreen_enter fullscreen_exit idle_enter idle_exit rescale lightbox_open lightbox_close lightbox_image".split(" "),function(a,b){U.push(b);/_/.test(b)&&U.push(b.replace(/_/g,""))}),U);var ha=function(a){var b;return"object"!=typeof a?a:(c.each(a,function(d,e){/^[a-z]+_/.test(d)&&(b="",c.each(d.split("_"),function(a,c){b+=0<a?c.substr(0,1).toUpperCase()+c.substr(1):c}),a[b]=e,delete a[d])}),a)},V=function(a){return-1<c.inArray(a,T)?Galleria[a.toUpperCase()]:a},H={youtube:{reg:/https?:\/\/(?:[a-zA_Z]{2,3}.)?(?:youtube\.com\/watch\?)((?:[\w\d\-\_\=]+&amp;(?:amp;)?)*v(?:&lt;[A-Z]+&gt;)?=([0-9a-zA-Z\-\_]+))/i,embed:function(a){return"http://www.youtube.com/embed/"+a},getThumb:function(a,b,d){d=d||s;c.getJSON(m.location.protocol+"//gdata.youtube.com/feeds/api/videos/"+a+"?v=2&alt=json-in-script&callback=?",function(a){try{b(a.entry.media$group.media$thumbnail[0].url)}catch(c){d()}}).error(d)}},vimeo:{reg:/https?:\/\/(?:www\.)?(vimeo\.com)\/(?:hd#)?([0-9]+)/i,embed:function(a){return"http://player.vimeo.com/video/"+a},getThumb:function(a,b,d){d=d||s;c.getJSON("http://vimeo.com/api/v2/video/"+a+".json?callback=?",function(a){try{b(a[0].thumbnail_medium)}catch(c){d()}}).error(d)}},dailymotion:{reg:/https?:\/\/(?:www\.)?(dailymotion\.com)\/video\/([^_]+)/,embed:function(a){return"http://www.dailymotion.com/embed/video/"+a},getThumb:function(a,b,d){d=d||s;c.getJSON("https://api.dailymotion.com/video/"+a+"?fields=thumbnail_medium_url&callback=?",function(a){try{b(a.thumbnail_medium_url)}catch(c){d()}}).error(d)}}},ia=function(a){var b,c;for(c in H)if((b=a&&a.match(H[c].reg))&&b.length)return{id:b[2],provider:c};return!1},x=v().html,y={support:!K&&(x.requestFullscreen||x.mozRequestFullScreen||x.webkitRequestFullScreen),callback:s,enter:function(a,b,c){this.instance=a;this.callback=b||s;c=c||v().html;c.requestFullscreen?c.requestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullScreen&&c.webkitRequestFullScreen()},exit:function(a){this.callback=a||s;n.exitFullscreen?n.exitFullscreen():n.mozCancelFullScreen?n.mozCancelFullScreen():n.webkitCancelFullScreen&&n.webkitCancelFullScreen()},instance:null,listen:function(){if(this.support){var a=function(){if(y.instance){var a=y.instance._fullscreen;n.fullscreen||n.mozFullScreen||n.webkitIsFullScreen?a._enter(y.callback):a._exit(y.callback)}};n.addEventListener("fullscreenchange",a,!1);n.addEventListener("mozfullscreenchange",a,!1);n.addEventListener("webkitfullscreenchange",a,!1)}}},W=[],F=[],ja=!1,z=!1,X=[],Y=function(a){Galleria.theme=a;c.each(X,function(a,c){c._initialized||c._init.call(c)});X=[]},N;a:{x=["transition","WebkitTransition","MozTransition","OTransition"];if(!m.opera)for(E=0;x[E];E++)if("undefined"!=typeof(n.body||n.documentElement).style[x[E]]){N=x[E];break a}N=!1}var ka={MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[N],Z={_default:[0.25,0.1,0.25,1],galleria:[0.645,0.045,0.355,1],galleriaIn:[0.55,0.085,0.68,0.53],galleriaOut:[0.25,0.46,0.45,0.94],ease:[0.25,0,0.25,1],linear:[0.25,0.25,0.75,0.75],"ease-in":[0.42,0,1,1],"ease-out":[0,0,0.58,1],"ease-in-out":[0.42,0,0.58,1]},O=function(a,b,d){var e={};d=d||"transition";c.each(["webkit","moz","ms","o"],function(){e["-"+this+"-"+d]=b});a.css(e)},la=function(a){O(a,"none","transition");Galleria.WEBKIT&&Galleria.TOUCH&&(O(a,"translate3d(0,0,0)","transform"),a.data("revert")&&(a.css(a.data("revert")),a.data("revert",null)))},aa,P,ma,na,ba,L,ca,A,G,da,Q,oa={},ra=function(a){a.preventDefault();oa=c.extend({},a,!0)},sa=function(){this.evt=oa},ta=function(){this.handler.call(A,this.evt)},f={clearTimer:function(a){c.each(Galleria.get(),function(){this.clearTimer(a)})},addTimer:function(a){c.each(Galleria.get(),function(){this.addTimer(a)})},array:function(a){return B.slice.call(a,0)},create:function(a,b){var c=n.createElement(b||"div");return c.className=a,c},removeFromArray:function(a,b){return c.each(a,function(c,e){if(e==b)return a.splice(c,1),!1}),a},getScriptPath:function(a){a=a||c("script:last").attr("src");a=a.split("/");return 1==a.length?"":(a.pop(),a.join("/")+"/")},animate:function(a,b,d){d=c.extend({duration:400,complete:s,stop:!1},d);a=c(a);d.duration?N?(d.stop&&(a.unbind(ka),la(a)),aa=!1,c.each(b,function(b,c){ca=a.css(b);f.parseValue(ca)!=f.parseValue(c)&&(aa=!0);a.css(b,ca)}),aa?(P=[],ma=d.easing in Z?Z[d.easing]:Z._default,na=" "+d.duration+"ms cubic-bezier("+ma.join(",")+")",m.setTimeout(function(a,b,l,h){return function(){a.one(b,function(a){return function(){la(a);d.complete.call(a[0])}}(a));if(Galleria.WEBKIT&&Galleria.TOUCH&&(ba={},L=[0,0,0],c.each(["left","top"],function(b,c){c in l&&(L[b]=f.parseValue(l[c])-f.parseValue(a.css(c))+"px",ba[c]=l[c],delete l[c])}),L[0]||L[1]))a.data("revert",ba),P.push("-webkit-transform"+h),O(a,"translate3d("+L.join(",")+")","transform");c.each(l,function(a){P.push(a+h)});O(a,P.join(","));a.css(l)}}(a,ka,b,na),2)):m.setTimeout(function(){d.complete.call(a[0])},d.duration)):a.animate(b,d):(a.css(b),d.complete.call(a[0]))},removeAlpha:function(a){if(9>q&&a){var b=a.style;a=(a=a.currentStyle)&&a.filter||b.filter||"";/alpha/.test(a)&&(b.filter=a.replace(/alpha\([^)]*\)/i,""))}},forceStyles:function(a,b){a=c(a);a.attr("style")&&a.data("styles",a.attr("style")).removeAttr("style");a.css(b)},revertStyles:function(){c.each(f.array(arguments),function(a,b){b=c(b);b.removeAttr("style");b.attr("style","");b.data("styles")&&b.attr("style",b.data("styles")).data("styles",null)})},moveOut:function(a){f.forceStyles(a,{position:"absolute",left:-1E4})},moveIn:function(){f.revertStyles.apply(f,f.array(arguments))},elem:function(a){return a instanceof c?{$:a,dom:a[0]}:{$:c(a),dom:a}},hide:function(a,b,c){c=c||s;var e=f.elem(a),g=e.$;a=e.dom;g.data("opacity")||g.data("opacity",g.css("opacity"));e={opacity:0};b?f.animate(a,e,{duration:b,complete:9>q&&a?function(){f.removeAlpha(a);a.style.visibility="hidden";c.call(a)}:c,stop:!0}):9>q&&a?(f.removeAlpha(a),a.style.visibility="hidden"):g.css(e)},show:function(a,b,c){c=c||s;var e=f.elem(a),g=e.$;a=e.dom;var l={opacity:parseFloat(g.data("opacity"))||1};b?(9>q&&(g.css("opacity",0),a.style.visibility="visible"),f.animate(a,l,{duration:b,complete:9>q&&a?function(){1==l.opacity&&f.removeAlpha(a);c.call(a)}:c,stop:!0})):9>q&&1==l.opacity&&a?(f.removeAlpha(a),a.style.visibility="visible"):g.css(l)},optimizeTouch:function(a){c(a).bind("touchend",function(a){A=a.target;for(Q=!0;A.parentNode&&A!=a.currentTarget&&Q;)G=c(A).data("events"),da=c(A).data("fakes"),G&&"click"in G?(Q=!1,a.preventDefault(),c(A).click(ra).click(),G.click.pop(),c.each(G.click,sa),c(A).data("fakes",G.click),delete G.click):da&&(Q=!1,a.preventDefault(),c.each(da,ta)),A=A.parentNode})},wait:function(a){a=c.extend({until:pa,success:s,error:function(){Galleria.raise("Could not complete wait function.")},timeout:3E3},a);var b=f.timestamp(),d,e,g=function(){e=f.timestamp();d=e-b;if(a.until(d))return a.success(),!1;if("number"==typeof a.timeout&&e>=b+a.timeout)return a.error(),!1;m.setTimeout(g,10)};m.setTimeout(g,10)},toggleQuality:function(a,b){7!==q&&8!==q||(!a||"IMG"!=a.nodeName.toUpperCase())||("undefined"==typeof b&&(b="nearest-neighbor"===a.style.msInterpolationMode),a.style.msInterpolationMode=b?"bicubic":"nearest-neighbor")},insertStyleTag:function(a,b){if(!b||!c("#"+b).length){var d=n.createElement("style");b&&(d.id=b);v().head.appendChild(d);if(d.styleSheet)d.styleSheet.cssText=a;else{var e=n.createTextNode(a);d.appendChild(e)}}},loadScript:function(a,b){var d=!1,e=c("<script>").attr({src:a,async:!0}).get(0);e.onload=e.onreadystatechange=function(){!d&&(!this.readyState||"loaded"===this.readyState||"complete"===this.readyState)&&(d=!0,e.onload=e.onreadystatechange=null,"function"==typeof b&&b.call(this,this))};v().head.appendChild(e)},parseValue:function(a){return"number"==typeof a?a:"string"==typeof a?(a=a.match(/\-?\d|\./g))&&a.constructor===Array?1*a.join(""):0:0},timestamp:function(){return(new Date).getTime()},loadCSS:function(a,b,d){var e,g;c("link[rel=stylesheet]").each(function(){if(RegExp(a).test(this.href))return e=this,!1});"function"==typeof b&&(d=b,b=void 0);d=d||s;if(e)return d.call(e,e),e;g=n.styleSheets.length;if(c("#"+b).length)c("#"+b).attr("href",a),g--;else if(e=c("<link>").attr({rel:"stylesheet",href:a,id:b}).get(0),b=c('link[rel="stylesheet"], style'),b.length?b.get(0).parentNode.insertBefore(e,b[0]):v().head.appendChild(e),q&&31<=g){Galleria.raise("You have reached the browser stylesheet limit (31)",!0);return}if("function"==typeof d){var l=c("<s>").attr("id","galleria-loader").hide().appendTo(v().body);f.wait({until:function(){return 1==l.height()},success:function(){l.remove();d.call(e,e)},error:function(){l.remove();Galleria.raise("Theme CSS could not load after 20 sec. "+(Galleria.QUIRK?"Your browser is in Quirks Mode, please add a correct doctype.":"Please download the latest theme at http://galleria.io/customer/."),!0)},timeout:5E3})}return e}},ea=function(a,b,d,e){var g=this.getOptions("easing"),l=this.getStageWidth(),h={left:l*(a.rewind?-1:1)},j={left:0};d?(h.opacity=0,j.opacity=1):h.opacity=1;c(a.next).css(h);f.animate(a.next,j,{duration:a.speed,complete:function(a){return function(){b();a.css({left:0})}}(c(a.next).add(a.prev)),queue:!1,easing:g});e&&(a.rewind=!a.rewind);a.prev&&(h={left:0},j={left:l*(a.rewind?1:-1)},d&&(h.opacity=1,j.opacity=0),c(a.prev).css(h),f.animate(a.prev,j,{duration:a.speed,queue:!1,easing:g,complete:function(){c(this).css("opacity",0)}}))};k=!1;p=function(a,b,c){r.hasOwnProperty(a)&&r[a].call(this,b,c)};r={fade:function(a,b){c(a.next).css({opacity:0,left:0});f.animate(a.next,{opacity:1},{duration:a.speed,complete:b});a.prev&&(c(a.prev).css("opacity",1).show(),f.animate(a.prev,{opacity:0},{duration:a.speed}))},flash:function(a,b){c(a.next).css({opacity:0,left:0});a.prev?f.animate(a.prev,{opacity:0},{duration:a.speed/2,complete:function(){f.animate(a.next,{opacity:1},{duration:a.speed,complete:b})}}):f.animate(a.next,{opacity:1},{duration:a.speed,complete:b})},pulse:function(a,b){a.prev&&c(a.prev).hide();c(a.next).css({opacity:0,left:0}).show();f.animate(a.next,{opacity:1},{duration:a.speed,complete:b})},slide:function(a,b){ea.apply(this,f.array(arguments))},fadeslide:function(a,b){ea.apply(this,f.array(arguments).concat([!0]))},doorslide:function(a,b){ea.apply(this,f.array(arguments).concat([!1,!0]))}};y.listen();Galleria=function(){var a=this;this._options={};this._playing=!1;this._playtime=5E3;this._active=null;this._queue={length:0};this._data=[];this._dom={};this._thumbnails=[];this._layers=[];this._firstrun=this._initialized=!1;this._stageHeight=this._stageWidth=0;this._target=void 0;this._binds=[];this._id=parseInt(1E4*Math.random(),10);c.each("container stage images image-nav image-nav-left image-nav-right info info-text info-title info-description thumbnails thumbnails-list thumbnails-container thumb-nav-left thumb-nav-right loader counter tooltip".split(" "),function(b,c){a._dom[c]=f.create("galleria-"+c)});c.each(["current","total"],function(b,c){a._dom[c]=f.create("galleria-"+c,"span")});var b=this._keyboard={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:!1,press:function(c){var d=c.keyCode||c.which;d in b.map&&"function"==typeof b.map[d]&&b.map[d].call(a,c)},attach:function(a){var c,d;for(c in a)a.hasOwnProperty(c)&&(d=c.toUpperCase(),d in b.keys?b.map[b.keys[d]]=a[c]:b.map[d]=a[c]);b.bound||(b.bound=!0,J.bind("keydown",b.press))},detach:function(){b.bound=!1;b.map={};J.unbind("keydown",b.press)}},d=this._controls={"0":void 0,1:void 0,active:0,swap:function(){d.active=d.active?0:1},getActive:function(){return d[d.active]},getNext:function(){return d[1-d.active]}},e=this._carousel={next:a.$("thumb-nav-right"),prev:a.$("thumb-nav-left"),width:0,current:0,max:0,hooks:[],update:function(){var b=0,d=0,g=[0];c.each(a._thumbnails,function(a,e){e.ready&&(b+=e.outerWidth||c(e.container).outerWidth(!0),g[a+1]=b,d=Math.max(d,e.outerHeight||c(e.container).outerHeight(!0)))});a.$("thumbnails").css({width:b,height:d});e.max=b;e.hooks=g;e.width=a.$("thumbnails-list").width();e.setClasses();a.$("thumbnails-container").toggleClass("galleria-carousel",b>e.width);e.width=a.$("thumbnails-list").width()},bindControls:function(){var b;e.next.bind("click",function(c){c.preventDefault();if("auto"===a._options.carouselSteps)for(b=e.current;b<e.hooks.length;b++){if(e.hooks[b]-e.hooks[e.current]>e.width){e.set(b-2);break}}else e.set(e.current+a._options.carouselSteps)});e.prev.bind("click",function(c){c.preventDefault();if("auto"===a._options.carouselSteps)for(b=e.current;0<=b;b--){if(e.hooks[e.current]-e.hooks[b]>e.width){e.set(b+2);break}if(0===b){e.set(0);break}}else e.set(e.current-a._options.carouselSteps)})},set:function(a){for(a=Math.max(a,0);e.hooks[a-1]+e.width>=e.max&&0<=a;)a--;e.current=a;e.animate()},getLast:function(a){return(a||e.current)-1},follow:function(a){if(0===a||a===e.hooks.length-2)e.set(a);else{for(var b=e.current;e.hooks[b]-e.hooks[e.current]<e.width&&b<=e.hooks.length;)b++;a-1<e.current?e.set(a-1):a+2>b&&e.set(a-b+e.current+2)}},setClasses:function(){e.prev.toggleClass("disabled",!e.current);e.next.toggleClass("disabled",e.hooks[e.current]+e.width>=e.max)},animate:function(){e.setClasses();var b=-1*e.hooks[e.current];isNaN(b)||f.animate(a.get("thumbnails"),{left:b},{duration:a._options.carouselSpeed,easing:a._options.easing,queue:!1})}},g=this._tooltip={initialized:!1,open:!1,timer:"tooltip"+a._id,swapTimer:"swap"+a._id,init:function(){g.initialized=!0;f.insertStyleTag(".galleria-tooltip{padding:3px 8px;max-width:50%;background:#ffe;color:#000;z-index:3;position:absolute;font-size:11px;line-height:1.3;opacity:0;box-shadow:0 0 2px rgba(0,0,0,.4);-moz-box-shadow:0 0 2px rgba(0,0,0,.4);-webkit-box-shadow:0 0 2px rgba(0,0,0,.4);}","galleria-tooltip");a.$("tooltip").css({opacity:0.8,visibility:"visible",display:"none"})},move:function(b){var c=a.getMousePosition(b).x;b=a.getMousePosition(b).y;var d=a.$("tooltip"),e=b,g=d.outerHeight(!0)+1,f=d.outerWidth(!0),h=g+15,f=a.$("container").width()-f-2,j=a.$("container").height()-g-2;!isNaN(c)&&!isNaN(e)&&(c+=10,e-=g+8,c=Math.max(0,Math.min(f,c)),e=Math.max(0,Math.min(j,e)),b<h&&(e=h),d.css({left:c,top:e}))},bind:function(b,d){if(!Galleria.TOUCH){g.initialized||g.init();var e=function(){a.$("container").unbind("mousemove",g.move);a.clearTimer(g.timer);a.$("tooltip").stop().animate({opacity:0},200,function(){a.$("tooltip").hide();a.addTimer(g.swapTimer,function(){g.open=!1},1E3)})},f=function(b,d){g.define(b,d);c(b).hover(function(){a.clearTimer(g.swapTimer);a.$("container").unbind("mousemove",g.move).bind("mousemove",g.move).trigger("mousemove");g.show(b);a.addTimer(g.timer,function(){a.$("tooltip").stop().show().animate({opacity:1});g.open=!0},g.open?0:500)},e).click(e)};"string"==typeof d?f(b in a._dom?a.get(b):b,d):c.each(b,function(b,c){f(a.get(b),c)})}},show:function(b){b=c(b in a._dom?a.get(b):b);var d=b.data("tt"),e=function(a){m.setTimeout(function(a){return function(){g.move(a)}}(a),10);b.unbind("mouseup",e)};if(d="function"==typeof d?d():d)a.$("tooltip").html(d.replace(/\s/,"&#160;")),b.bind("mouseup",e)},define:function(b,d){if("function"!=typeof d){var e=d;d=function(){return e}}b=c(b in a._dom?a.get(b):b).data("tt",d);g.show(b)}},l=this._fullscreen={scrolled:0,crop:void 0,active:!1,keymap:a._keyboard.map,parseCallback:function(b,d){return k?function(){"function"==typeof b&&b.call(a);var e=a._controls.getActive(),g=a._controls.getNext();a._scaleImage(g);a._scaleImage(e);d&&a._options.trueFullscreen&&c(e.container).add(g.container).trigger("transitionend")}:b},enter:function(b){b=l.parseCallback(b,!0);a._options.trueFullscreen&&y.support?(l.active=!0,f.forceStyles(a.get("container"),{width:"100%",height:"100%"}),a.rescale(),Galleria.MAC?Galleria.WEBKIT?(a.$("container").css("opacity",0).addClass("fullscreen"),m.setTimeout(function(){l.scale();a.$("container").css("opacity",1)},50)):(a.$("stage").css("opacity",0),m.setTimeout(function(){l.scale();a.$("stage").css("opacity",1)},4)):a.$("container").addClass("fullscreen"),t.resize(l.scale),y.enter(a,b,a.get("container"))):(l.scrolled=t.scrollTop(),m.scrollTo(0,0),l._enter(b))},_enter:function(b){l.active=!0;if(K){var d=l,e,g;e=n.referrer;var h=n.createElement("a"),j=m.location;e=(h.href=e,h.protocol!=j.protocol||h.hostname!=j.hostname||h.port!=j.port?(Galleria.raise("Parent fullscreen not available. Iframe protocol, domains and ports must match."),!1):(l.pd=m.parent.document,c(l.pd).find("iframe").each(function(){if((this.contentDocument||this.contentWindow.document)===n)return g=this,!1}),g));d.iframe=e}f.hide(a.getActiveImage());K&&l.iframe&&(l.iframe.scrolled=c(m.parent).scrollTop(),m.parent.scrollTo(0,0));d=a.getData();e=a._options;var k=!a._options.trueFullscreen||!y.support,h={height:"100%",overflow:"hidden",margin:0,padding:0};k&&(a.$("container").addClass("fullscreen"),f.forceStyles(a.get("container"),{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1E4}),f.forceStyles(v().html,h),f.forceStyles(v().body,h));K&&l.iframe&&(f.forceStyles(l.pd.documentElement,h),f.forceStyles(l.pd.body,h),f.forceStyles(l.iframe,c.extend(h,{width:"100%",height:"100%",top:0,left:0,position:"fixed",zIndex:1E4,border:"none"})));l.keymap=c.extend({},a._keyboard.map);a.attachKeyboard({escape:a.exitFullscreen,right:a.next,left:a.prev});l.crop=e.imageCrop;void 0!=e.fullscreenCrop&&(e.imageCrop=e.fullscreenCrop);if(d&&d.big&&d.image!==d.big){e=new Galleria.Picture;var R=e.isCached(d.big),p=a.getIndex(),I=a._thumbnails[p];a.trigger({type:Galleria.LOADSTART,cached:R,rewind:!1,index:p,imageTarget:a.getActiveImage(),thumbTarget:I,galleriaData:d});e.load(d.big,function(b){a._scaleImage(b,{complete:function(b){a.trigger({type:Galleria.LOADFINISH,cached:R,index:p,rewind:!1,imageTarget:b.image,thumbTarget:I});var d=a._controls.getActive().image;d&&c(d).width(b.image.width).height(b.image.height).attr("style",c(b.image).attr("style")).attr("src",b.image.src)}})})}a.rescale(function(){a.addTimer(!1,function(){k&&f.show(a.getActiveImage());"function"==typeof b&&b.call(a)},100);a.trigger(Galleria.FULLSCREEN_ENTER)});k?t.resize(l.scale):f.show(a.getActiveImage())},scale:function(){a.rescale()},exit:function(b){b=l.parseCallback(b);a._options.trueFullscreen&&y.support?y.exit(b):l._exit(b)},_exit:function(b){l.active=!1;var c=!a._options.trueFullscreen||!y.support;a.$("container").removeClass("fullscreen");c&&(f.hide(a.getActiveImage()),f.revertStyles(a.get("container"),v().html,v().body),m.scrollTo(0,l.scrolled));K&&l.iframe&&(f.revertStyles(l.pd.documentElement,l.pd.body,l.iframe),l.iframe.scrolled&&m.parent.scrollTo(0,l.iframe.scrolled));a.detachKeyboard();a.attachKeyboard(l.keymap);a._options.imageCrop=l.crop;var d=a.getData().big,e=a._controls.getActive().image;!a.getData().iframe&&e&&d&&d==e.src&&m.setTimeout(function(a){return function(){e.src=a}}(a.getData().image),1);a.rescale(function(){a.addTimer(!1,function(){c&&f.show(a.getActiveImage());"function"==typeof b&&b.call(a);t.trigger("resize")},50);a.trigger(Galleria.FULLSCREEN_EXIT)});t.unbind("resize",l.scale)}},h=this._idle={trunk:[],bound:!1,active:!1,add:function(a,b,d,e){if(a){h.bound||h.addEvent();a=c(a);"boolean"==typeof d&&(e=d,d={});d=d||{};var g={},f;for(f in b)b.hasOwnProperty(f)&&(g[f]=a.css(f));a.data("idle",{from:c.extend(g,d),to:b,complete:!0,busy:!1});e?a.css(b):h.addTimer();h.trunk.push(a)}},remove:function(b){b=c(b);c.each(h.trunk,function(a,c){c&&c.length&&!c.not(b).length&&(b.css(b.data("idle").from),h.trunk.splice(a,1))});h.trunk.length||(h.removeEvent(),a.clearTimer(h.timer))},addEvent:function(){h.bound=!0;a.$("container").bind("mousemove click",h.showAll);"hover"==a._options.idleMode&&a.$("container").bind("mouseleave",h.hide)},removeEvent:function(){h.bound=!1;a.$("container").bind("mousemove click",h.showAll);"hover"==a._options.idleMode&&a.$("container").unbind("mouseleave",h.hide)},addTimer:function(){"hover"!=a._options.idleMode&&a.addTimer("idle",function(){h.hide()},a._options.idleTime)},hide:function(){if(a._options.idleMode&&!(!1===a.getIndex()||a.getData().iframe)){a.trigger(Galleria.IDLE_ENTER);var b=h.trunk.length;c.each(h.trunk,function(c,d){var e=d.data("idle");e&&(d.data("idle").complete=!1,f.animate(d,e.to,{duration:a._options.idleSpeed,complete:function(){c==b-1&&(h.active=!1)}}))})}},showAll:function(){a.clearTimer("idle");c.each(h.trunk,function(a,b){h.show(b)})},show:function(b){var d=b.data("idle");if(!h.active||!d.busy&&!d.complete)d.busy=!0,a.trigger(Galleria.IDLE_EXIT),a.clearTimer("idle"),f.animate(b,d.from,{duration:a._options.idleSpeed/2,complete:function(){h.active=!0;c(b).data("idle").busy=!1;c(b).data("idle").complete=!0}});h.addTimer()}},j=this._lightbox={width:0,height:0,initialized:!1,active:null,image:null,elems:{},keymap:!1,init:function(){a.trigger(Galleria.LIGHTBOX_OPEN);if(!j.initialized){j.initialized=!0;var b={},d=a._options,e="",d={overlay:"position:fixed;display:none;opacity:"+d.overlayOpacity+";filter:alpha(opacity="+100*d.overlayOpacity+");top:0;left:0;width:100%;height:100%;background:"+d.overlayBackground+";z-index:99990",box:"position:fixed;display:none;width:400px;height:400px;top:50%;left:50%;margin-top:-200px;margin-left:-200px;z-index:99991",shadow:"position:absolute;background:#000;width:100%;height:100%;",content:"position:absolute;background-color:#fff;top:10px;left:10px;right:10px;bottom:10px;overflow:hidden",info:"position:absolute;bottom:10px;left:10px;right:10px;color:#444;font:11px/13px arial,sans-serif;height:13px",close:"position:absolute;top:10px;right:10px;height:20px;width:20px;background:#fff;text-align:center;cursor:pointer;color:#444;font:16px/22px arial,sans-serif;z-index:99999",image:"position:absolute;top:10px;left:10px;right:10px;bottom:30px;overflow:hidden;display:block;",prevholder:"position:absolute;width:50%;top:0;bottom:40px;cursor:pointer;",nextholder:"position:absolute;width:50%;top:0;bottom:40px;right:-1px;cursor:pointer;",prev:"position:absolute;top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;left:20px;display:none;text-align:center;color:#000;font:bold 16px/36px arial,sans-serif",next:"position:absolute;top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;right:20px;left:auto;display:none;font:bold 16px/36px arial,sans-serif;text-align:center;color:#000",title:"float:left",counter:"float:right;margin-left:8px;"},g={};q&&7<q&&(d.nextholder+="background:#000;filter:alpha(opacity=0);",d.prevholder+="background:#000;filter:alpha(opacity=0);");c.each(d,function(a,b){e+=".galleria-lightbox-"+a+"{"+b+"}"});e+=".galleria-lightbox-box.iframe .galleria-lightbox-prevholder,.galleria-lightbox-box.iframe .galleria-lightbox-nextholder{width:100px;height:100px;top:50%;margin-top:-70px}";f.insertStyleTag(e,"galleria-lightbox");c.each("overlay box content shadow title info close prevholder prev nextholder next counter image".split(" "),function(c,d){a.addElement("lightbox-"+d);b[d]=j.elems[d]=a.get("lightbox-"+d)});j.image=new Galleria.Picture;c.each({box:"shadow content close prevholder nextholder",info:"title counter",content:"info image",prevholder:"prev",nextholder:"next"},function(a,b){var d=[];c.each(b.split(" "),function(a,b){d.push("lightbox-"+b)});g["lightbox-"+a]=d});a.append(g);c(b.image).append(j.image.container);c(v().body).append(b.overlay,b.box);f.optimizeTouch(b.box);c(b.close).bind("click",j.hide).html("&#215;").hover(function(){c(this).css("color","#bbb")},function(){c(this).css("color","#444")});c.each(["Prev","Next"],function(a,d){var e=c(b[d.toLowerCase()]).html(/v/.test(d)?"&#8249;&#160;":"&#160;&#8250;"),g=c(b[d.toLowerCase()+"holder"]);g.bind("click",function(){j["show"+d]()});8>q||Galleria.TOUCH?e.show():g.hover(function(){e.show()},function(){e.stop().fadeOut(200)})});c(b.overlay).bind("click",j.hide);Galleria.IPAD&&(a._options.lightboxTransitionSpeed=0)}},rescale:function(b){var d=Math.min(t.width()-40,j.width),e=Math.min(t.height()-60,j.height),e=Math.min(d/j.width,e/j.height),d=Math.round(j.width*e)+40,e=Math.round(j.height*e)+60,d={width:d,height:e,"margin-top":-1*Math.ceil(e/2),"margin-left":-1*Math.ceil(d/2)};b?c(j.elems.box).css(d):c(j.elems.box).animate(d,{duration:a._options.lightboxTransitionSpeed,easing:a._options.easing,complete:function(){var b=j.image,d=a._options.lightboxFadeSpeed;a.trigger({type:Galleria.LIGHTBOX_IMAGE,imageTarget:b.image});c(b.container).show();c(b.image).animate({opacity:1},d);f.show(j.elems.info,d)}})},hide:function(){j.image.image=null;t.unbind("resize",j.rescale);c(j.elems.box).hide();f.hide(j.elems.info);a.detachKeyboard();a.attachKeyboard(j.keymap);j.keymap=!1;f.hide(j.elems.overlay,200,function(){c(this).hide().css("opacity",a._options.overlayOpacity);a.trigger(Galleria.LIGHTBOX_CLOSE)})},showNext:function(){j.show(a.getNext(j.active))},showPrev:function(){j.show(a.getPrev(j.active))},show:function(b){j.active=b="number"==typeof b?b:a.getIndex()||0;j.initialized||j.init();j.keymap||(j.keymap=c.extend({},a._keyboard.map),a.attachKeyboard({escape:j.hide,right:j.showNext,left:j.showPrev}));t.unbind("resize",j.rescale);var d=a.getData(b),e=a.getDataLength(),g=a.getNext(b),h,l,k;f.hide(j.elems.info);try{for(k=a._options.preload;0<k;k--)l=new Galleria.Picture,h=a.getData(g),l.preload("big"in h?h.big:h.image),g=a.getNext(g)}catch(n){}j.image.isIframe=!!d.iframe;c(j.elems.box).toggleClass("iframe",!!d.iframe);j.image.load(d.iframe||d.big||d.image,function(g){if(g.isIframe){var h=c(m).width(),f=c(m).height();if(a._options.maxVideoSize){var l=Math.min(a._options.maxVideoSize/h,a._options.maxVideoSize/f);1>l&&(h*=l,f*=l)}j.width=h;j.height=f}else j.width=g.original.width,j.height=g.original.height;c(g.image).css({width:g.isIframe?"100%":"100.1%",height:g.isIframe?"100%":"100.1%",top:0,zIndex:99998,opacity:0,visibility:"visible"});j.elems.title.innerHTML=d.title||"";j.elems.counter.innerHTML=b+1+" / "+e;t.resize(j.rescale);j.rescale()});c(j.elems.overlay).show().css("visibility","visible");c(j.elems.box).show()}},R=this._timer={trunk:{},add:function(a,b,c,d){a=a||(new Date).getTime();d=d||!1;this.clear(a);if(d){var e=b;b=function(){e();R.add(a,b,c)}}this.trunk[a]=m.setTimeout(b,c)},clear:function(a){var b;if(a&&a in this.trunk)m.clearTimeout(this.trunk[a]),delete this.trunk[a];else if("undefined"==typeof a)for(b in this.trunk)this.trunk.hasOwnProperty(b)&&(a=b,m.clearTimeout(this.trunk[a]),delete this.trunk[a])}};return this};Galleria.prototype={constructor:Galleria,init:function(a,b){b=ha(b);this._original={target:a,options:b,data:null};this._target=this._dom.target=a.nodeName?a:c(a).get(0);this._original.html=this._target.innerHTML;F.push(this);if(this._target)return this._options={autoplay:!1,carousel:!0,carouselFollow:!0,carouselSpeed:400,carouselSteps:"auto",clicknext:!1,dailymotion:{foreground:"%23EEEEEE",highlight:"%235BCEC5",background:"%23222222",logo:0,hideInfos:1},dataConfig:function(){return{}},dataSelector:"img",dataSort:!1,dataSource:this._target,debug:void 0,dummy:void 0,easing:"galleria",extend:function(){},fullscreenCrop:void 0,fullscreenDoubleTap:!0,fullscreenTransition:void 0,height:0,idleMode:!0,idleTime:3E3,idleSpeed:200,imageCrop:!1,imageMargin:0,imagePan:!1,imagePanSmoothness:12,imagePosition:"50%",imageTimeout:void 0,initialTransition:void 0,keepSource:!1,layerFollow:!0,lightbox:!1,lightboxFadeSpeed:200,lightboxTransitionSpeed:200,linkSourceImages:!0,maxScaleRatio:void 0,maxVideoSize:void 0,minScaleRatio:void 0,overlayOpacity:0.85,overlayBackground:"#0b0b0b",pauseOnInteraction:!0,popupLinks:!1,preload:2,queue:!0,responsive:!0,show:0,showInfo:!0,showCounter:!0,showImagenav:!0,swipe:!0,thumbCrop:!0,thumbEventType:"click",thumbFit:!0,thumbMargin:0,thumbQuality:"auto",thumbDisplayOrder:!0,thumbnails:!0,touchTransition:void 0,transition:"fade",transitionInitial:void 0,transitionSpeed:400,trueFullscreen:!0,useCanvas:!1,vimeo:{title:0,byline:0,portrait:0,color:"aaaaaa"},wait:5E3,width:"auto",youtube:{modestbranding:1,autohide:1,color:"white",hd:1,rel:0,showinfo:0}},this._options.initialTransition=this._options.initialTransition||this._options.transitionInitial,b&&!1===b.debug&&(fa=!1),b&&"string"==typeof b.dummy&&(S=b.dummy),c(this._target).children().hide(),Galleria.QUIRK&&Galleria.raise("Your page is in Quirks mode, Galleria may not render correctly. Please validate your HTML and add a correct doctype."),"object"==typeof Galleria.theme?this._init():X.push(this),this;Galleria.raise("Target not found",!0)},_init:function(){var a=this,b=this._options;if(this._initialized)return Galleria.raise("Init failed: Gallery instance already initialized."),this;this._initialized=!0;if(!Galleria.theme)return Galleria.raise("Init failed: No theme found.",!0),this;c.extend(!0,b,Galleria.theme.defaults,this._original.options,Galleria.configure.options);var d=n.createElement("canvas");"getContext"in d&&(z=z||{elem:d,context:d.getContext("2d"),cache:{},length:0});this.bind(Galleria.DATA,function(){this._original.data=this._data;this.get("total").innerHTML=this.getDataLength();var b=this.$("container");2>a._options.height&&(a._userRatio=a._ratio=a._options.height);var c={width:0,height:0},d=function(){return a.$("stage").height()};f.wait({until:function(){return c=a._getWH(),b.width(c.width).height(c.height),d()&&c.width&&50<c.height},success:function(){a._width=c.width;a._height=c.height;a._ratio=a._ratio||c.height/c.width;Galleria.WEBKIT?m.setTimeout(function(){a._run()},1):a._run()},error:function(){d()?Galleria.raise("Could not extract sufficient width/height of the gallery container. Traced measures: width:"+c.width+"px, height: "+c.height+"px.",!0):Galleria.raise("Could not extract a stage height from the CSS. Traced height: "+d()+"px.",!0)},timeout:"number"==typeof this._options.wait?this._options.wait:!1})});this.append({"info-text":["info-title","info-description"],info:["info-text"],"image-nav":["image-nav-right","image-nav-left"],stage:["images","loader","counter","image-nav"],"thumbnails-list":["thumbnails"],"thumbnails-container":["thumb-nav-left","thumbnails-list","thumb-nav-right"],container:["stage","thumbnails-container","info","tooltip"]});f.hide(this.$("counter").append(this.get("current"),n.createTextNode(" / "),this.get("total")));this.setCounter("&#8211;");f.hide(a.get("tooltip"));this.$("container").addClass(Galleria.TOUCH?"touch":"notouch");c.each(Array(2),function(b){var d=new Galleria.Picture;c(d.container).css({position:"absolute",top:0,left:0}).prepend(a._layers[b]=c(f.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]);a.$("images").append(d.container);a._controls[b]=d});this.$("images").css({position:"relative",top:0,left:0,width:"100%",height:"100%"});this.$("thumbnails, thumbnails-list").css({overflow:"hidden",position:"relative"});this.$("image-nav-right, image-nav-left").bind("click",function(c){b.clicknext&&c.stopPropagation();b.pauseOnInteraction&&a.pause();c=/right/.test(this.className)?"next":"prev";a[c]()});c.each(["info","counter","image-nav"],function(c,d){!1===b["show"+d.substr(0,1).toUpperCase()+d.substr(1).replace(/-/,"")]&&f.moveOut(a.get(d.toLowerCase()))});this.load();!b.keepSource&&!q&&(this._target.innerHTML="");this.get("errors")&&this.appendChild("target","errors");this.appendChild("target","container");if(b.carousel){var e=0,g=b.show;this.bind(Galleria.THUMBNAIL,function(){this.updateCarousel();++e==this.getDataLength()&&"number"==typeof g&&0<g&&this._carousel.follow(g)})}b.responsive&&t.bind("resize",function(){a.isFullscreen()||a.resize()});if(b.swipe){var l=a.$("images"),h=[0,0],j=[0,0],k=!1,M=0,w,C=function(a){a.originalEvent.touches&&1<a.originalEvent.touches.length||(w=a.originalEvent.touches?a.originalEvent.touches[0]:a,j=[w.pageX,w.pageY],h[0]||(h=j),10<Math.abs(h[0]-j[0])&&a.preventDefault())},p=function(b){l.unbind("touchmove",C);b.originalEvent.touches&&b.originalEvent.touches.length||k?k=!k:(1E3>f.timestamp()-M&&30<Math.abs(h[0]-j[0])&&100>Math.abs(h[1]-j[1])&&(b.preventDefault(),a[h[0]>j[0]?"next":"prev"]()),h=j=[0,0])};l.bind("touchstart",function(a){a.originalEvent.touches&&1<a.originalEvent.touches.length||(w=a.originalEvent.touches?a.originalEvent.touches[0]:a,M=f.timestamp(),h=j=[w.pageX,w.pageY],l.bind("touchmove",C).one("touchend",p))});b.fullscreenDoubleTap&&this.$("stage").bind("touchstart",function(){var b,c,d,e,g,h;return function(f){h=Galleria.utils.timestamp();c=(f.originalEvent.touches?f.originalEvent.touches[0]:f).pageX;d=(f.originalEvent.touches?f.originalEvent.touches[0]:f).pageY;500>h-b&&20>c-e&&20>d-g?(a.toggleFullscreen(),f.preventDefault(),a.$("stage").unbind("touchend",arguments.callee)):(b=h,e=c,g=d)}}())}return f.optimizeTouch(this.get("container")),c.each(Galleria.on.binds,function(b,d){-1==c.inArray(d.hash,a._binds)&&a.bind(d.type,d.callback)}),this},addTimer:function(){return this._timer.add.apply(this._timer,f.array(arguments)),this},clearTimer:function(){return this._timer.clear.apply(this._timer,f.array(arguments)),this},_getWH:function(){var a=this.$("container"),b=this.$("target"),d=this,e={},g;return c.each(["width","height"],function(c,h){d._options[h]&&"number"==typeof d._options[h]?e[h]=d._options[h]:(g=[f.parseValue(a.css(h)),f.parseValue(b.css(h)),a[h](),b[h]()],d["_"+h]||g.splice(g.length,f.parseValue(a.css("min-"+h)),f.parseValue(b.css("min-"+h))),e[h]=Math.max.apply(Math,g))}),d._userRatio&&(e.height=e.width*d._userRatio),e},_createThumbnails:function(a){this.get("total").innerHTML=this.getDataLength();var b,d,e,g,l=this,h=this._options,j=a?this._data.length-a.length:0,k=j,M=[],w=0,C=8>q?"http://upload.wikimedia.org/wikipedia/commons/c/c0/Blank.gif":"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw%3D%3D",p;p=l.$("thumbnails").find(".active");p=p.length?p.find("img").attr("src"):!1;var u="string"==typeof h.thumbnails?h.thumbnails.toLowerCase():null,r=function(a){return n.defaultView&&n.defaultView.getComputedStyle?n.defaultView.getComputedStyle(b.container,null)[a]:g.css(a)},t=function(a,b,d){return function(){c(d).append(a);l.trigger({type:Galleria.THUMBNAIL,thumbTarget:a,index:b,galleriaData:l.getData(b)})}},ua=function(a){h.pauseOnInteraction&&l.pause();var b=c(a.currentTarget).data("index");l.getIndex()!==b&&l.show(b);a.preventDefault()},s=function(a,b){c(a.container).css("visibility","visible");l.trigger({type:Galleria.THUMBNAIL,thumbTarget:a.image,index:a.data.order,galleriaData:l.getData(a.data.order)});"function"==typeof b&&b.call(l,a)},I=function(a,b){a.scale({width:a.data.width,height:a.data.height,crop:h.thumbCrop,margin:h.thumbMargin,canvas:h.useCanvas,complete:function(a){var d=["left","top"],e,g,j=l.getData(a.index),k=j.thumb.split(":");c.each(["Width","Height"],function(b,f){e=f.toLowerCase();(!0!==h.thumbCrop||h.thumbCrop===e)&&h.thumbFit&&(g={},g[e]=a[e],c(a.container).css(g),g={},g[d[b]]=0,c(a.image).css(g));a["outer"+f]=c(a.container)["outer"+f](!0)});f.toggleQuality(a.image,!0===h.thumbQuality||"auto"===h.thumbQuality&&a.original.width<3*a.width);j.iframe&&2==k.length&&k[0]in H?H[k[0]].getThumb(k[1],function(c){return function(d){c.src=d;s(a,b)}}(a.image)):h.thumbDisplayOrder&&!a.lazy?c.each(M,function(a,c){a===w&&(c.ready&&!c.displayed)&&(w++,c.displayed=!0,s(c,b))}):s(a,b)}})};for(a||(this._thumbnails=[],this.$("thumbnails").empty());this._data[j];j++)d=this._data[j],a=d.thumb||d.image,!0!==h.thumbnails&&"lazy"!=u||!d.thumb&&!d.image?d.iframe||"empty"===u||"numbers"===u?(b={container:f.create("galleria-image"),image:f.create("img","span"),ready:!0},"numbers"===u&&c(b.image).text(j+1),d.iframe&&c(b.image).addClass("iframe"),this.$("thumbnails").append(b.container),m.setTimeout(t(b.image,j,b.container),50+20*j)):b={container:null,image:null}:(b=new Galleria.Picture(j),b.index=j,b.displayed=!1,b.lazy=!1,b.video=!1,this.$("thumbnails").append(b.container),g=c(b.container),g.css("visibility","hidden"),b.data={width:f.parseValue(r("width")),height:f.parseValue(r("height")),order:j,src:a},h.thumbFit&&!0!==h.thumbCrop?g.css({width:"auto",height:"auto"}):g.css({width:b.data.width,height:b.data.height}),e=a.split(":"),2==e.length&&e[0]in H?(b.video=!0,b.ready=!0,b.load(C,{height:b.data.height,width:1.25*b.data.height},I)):"lazy"==u?(g.addClass("lazy"),b.lazy=!0,b.load(C,{height:b.data.height,width:b.data.width})):b.load(a,I),"all"===h.preload&&b.preload(d.image)),c(b.container).add(h.keepSource&&h.linkSourceImages?d.original:null).data("index",j).bind(h.thumbEventType,ua).data("thumbload",I),p===a&&c(b.container).addClass("active"),this._thumbnails.push(b);return M=this._thumbnails.slice(k),this},lazyLoad:function(a,b){var d=a.constructor==Array?a:[a],e=this;this.$("thumbnails").children().filter(function(){return c(this).data("lazy-src")});var g=0;return c.each(d,function(a,f){if(!(f>e._thumbnails.length-1)){var j=e._thumbnails[f],k=j.data;k.src.split(":");var m=function(){++g==d.length&&"function"==typeof b&&b.call(e)},n=c(j.container).data("thumbload");j.video?n.call(e,j,m):j.load(k.src,function(a){n.call(e,a,m)})}}),this},lazyLoadChunks:function(a,b){var c=this.getDataLength(),e=0,g=0,f=[],h=[],j=this;for(b=b||0;e<c;e++)if(h.push(e),++g==a||e==c-1)f.push(h),g=0,h=[];var k=function(a){var c=f.shift();c&&m.setTimeout(function(){j.lazyLoad(c,function(){k(!0)})},b&&a?b:0)};return k(!1),this},_run:function(){var a=this;a._createThumbnails();f.wait({timeout:1E4,until:function(){return Galleria.OPERA&&a.$("stage").css("display","inline-block"),a._stageWidth=a.$("stage").width(),a._stageHeight=a.$("stage").height(),a._stageWidth&&50<a._stageHeight},success:function(){W.push(a);f.show(a.get("counter"));a._options.carousel&&a._carousel.bindControls();a._options.autoplay&&(a.pause(),"number"==typeof a._options.autoplay&&(a._playtime=a._options.autoplay),a._playing=!0);a._firstrun?(a._options.autoplay&&a.trigger(Galleria.PLAY),"number"==typeof a._options.show&&a.show(a._options.show)):(a._firstrun=!0,Galleria.History&&Galleria.History.change(function(b){isNaN(b)?m.history.go(-1):a.show(b,void 0,!0)}),a.trigger(Galleria.READY),Galleria.theme.init.call(a,a._options),c.each(Galleria.ready.callbacks,function(b,c){"function"==typeof c&&c.call(a,a._options)}),a._options.extend.call(a,a._options),/^[0-9]{1,4}$/.test(ga)&&Galleria.History?a.show(ga,void 0,!0):a._data[a._options.show]&&a.show(a._options.show),a._options.autoplay&&a.trigger(Galleria.PLAY))},error:function(){Galleria.raise("Stage width or height is too small to show the gallery. Traced measures: width:"+a._stageWidth+"px, height: "+a._stageHeight+"px.",!0)}})},load:function(a,b,d){var e=this,g=this._options;return this._data=[],this._thumbnails=[],this.$("thumbnails").empty(),"function"==typeof b&&(d=b,b=null),a=a||g.dataSource,b=b||g.dataSelector,d=d||g.dataConfig,/^function Object/.test(a.constructor)&&(a=[a]),a.constructor===Array?this.validate(a)?this._data=a:Galleria.raise("Load failed: JSON Array not valid."):(b+=",.video,.iframe",c(a).find(b).each(function(a,b){b=c(b);var g={},f=b.parent(),k=f.attr("href"),f=f.attr("rel");k&&("IMG"==b[0].nodeName||b.hasClass("video"))&&ia(k)?g.video=k:k&&b.hasClass("iframe")?g.iframe=k:g.image=g.big=k;f&&(g.big=f);c.each(["big","title","description","link","layer"],function(a,c){b.data(c)&&(g[c]=b.data(c))});e._data.push(c.extend({title:b.attr("title")||"",thumb:b.attr("src"),image:b.attr("src"),big:b.attr("src"),description:b.attr("alt")||"",link:b.attr("longdesc"),original:b.get(0)},g,d(b)))})),"function"==typeof g.dataSort?B.sort.call(this._data,g.dataSort):"random"==g.dataSort&&this._data.sort(function(){return Math.round(Math.random())-0.5}),this.getDataLength()&&this._parseData().trigger(Galleria.DATA),this},_parseData:function(){var a=this,b;return c.each(this._data,function(d,e){b=a._data[d];0=="thumb"in e&&(b.thumb=e.image);!1 in e&&(b.big=e.image);if("video"in e){var g=ia(e.video);if(g){var f=H[g.provider].embed(g.id),h;if("object"==typeof a._options[g.provider]){var j=[];h=(c.each(a._options[g.provider],function(a,b){j.push(a+"="+b)}),"youtube"==g.provider&&(j=["wmode=opaque"].concat(j)),"?"+j.join("&"))}else h="";b.iframe=f+h;delete b.video;if(!("thumb"in b)||!b.thumb)b.thumb=g.provider+":"+g.id}}}),this},destroy:function(){return this.$("target").data("galleria",null),this.$("container").unbind("galleria"),this.get("target").innerHTML=this._original.html,this.clearTimer(),f.removeFromArray(F,this),f.removeFromArray(W,this),this},splice:function(){var a=this,b=f.array(arguments);return m.setTimeout(function(){B.splice.apply(a._data,b);a._parseData()._createThumbnails()},2),a},push:function(){var a=this,b=f.array(arguments);return 1==b.length&&b[0].constructor==Array&&(b=b[0]),m.setTimeout(function(){B.push.apply(a._data,b);a._parseData()._createThumbnails(b)},2),a},_getActive:function(){return this._controls.getActive()},validate:function(){return!0},bind:function(a,b){return a=V(a),this.$("container").bind(a,this.proxy(b)),this},unbind:function(a){return a=V(a),this.$("container").unbind(a),this},trigger:function(a){return a="object"==typeof a?c.extend(a,{scope:this}):{type:V(a),scope:this},this.$("container").trigger(a),this},addIdleState:function(a,b,c,e){return this._idle.add.apply(this._idle,f.array(arguments)),this},removeIdleState:function(a){return this._idle.remove.apply(this._idle,f.array(arguments)),this},enterIdleMode:function(){return this._idle.hide(),this},exitIdleMode:function(){return this._idle.showAll(),this},enterFullscreen:function(a){return this._fullscreen.enter.apply(this,f.array(arguments)),this},exitFullscreen:function(a){return this._fullscreen.exit.apply(this,f.array(arguments)),this},toggleFullscreen:function(a){return this._fullscreen[this.isFullscreen()?"exit":"enter"].apply(this,f.array(arguments)),this},bindTooltip:function(a,b){return this._tooltip.bind.apply(this._tooltip,f.array(arguments)),this},defineTooltip:function(a,b){return this._tooltip.define.apply(this._tooltip,f.array(arguments)),this},refreshTooltip:function(a){return this._tooltip.show.apply(this._tooltip,f.array(arguments)),this},openLightbox:function(){return this._lightbox.show.apply(this._lightbox,f.array(arguments)),this},closeLightbox:function(){return this._lightbox.hide.apply(this._lightbox,f.array(arguments)),this},getActiveImage:function(){return this._getActive().image||void 0},getActiveThumb:function(){return this._thumbnails[this._active].image||void 0},getMousePosition:function(a){return{x:a.pageX-this.$("container").offset().left,y:a.pageY-this.$("container").offset().top}},addPan:function(a){if(!1!==this._options.imageCrop){a=c(a||this.getActiveImage());var b=this,d=a.width()/2,e=a.height()/2,g=parseInt(a.css("left"),10),l=parseInt(a.css("top"),10),h=g||0,j=l||0,k=0,m=0,n=!1,p=f.timestamp(),r=0,u=0,s=function(b,c,d){if(0<b&&(u=Math.round(Math.max(-1*b,Math.min(0,c))),r!==u))if(r=u,8===q)a.parent()["scroll"+d](-1*u);else b={},b[d.toLowerCase()]=u,a.css(b)},t=function(a){50>f.timestamp()-p||(n=!0,d=b.getMousePosition(a).x,e=b.getMousePosition(a).y)};return 8===q&&(a.parent().scrollTop(-1*j).scrollLeft(-1*h),a.css({top:0,left:0})),this.$("stage").unbind("mousemove",t).bind("mousemove",t),this.addTimer("pan"+b._id,function(){n&&(k=a.width()-b._stageWidth,m=a.height()-b._stageHeight,g=-1*d/b._stageWidth*k,l=-1*e/b._stageHeight*m,h+=(g-h)/b._options.imagePanSmoothness,j+=(l-j)/b._options.imagePanSmoothness,s(m,j,"Top"),s(k,h,"Left"))},50,!0),this}},proxy:function(a,b){return"function"!=typeof a?s:(b=b||this,function(){return a.apply(b,f.array(arguments))})},removePan:function(){return this.$("stage").unbind("mousemove"),this.clearTimer("pan"+this._id),this},addElement:function(a){var b=this._dom;return c.each(f.array(arguments),function(a,c){b[c]=f.create("galleria-"+c)}),this},attachKeyboard:function(a){return this._keyboard.attach.apply(this._keyboard,f.array(arguments)),this},detachKeyboard:function(){return this._keyboard.detach.apply(this._keyboard,f.array(arguments)),this},appendChild:function(a,b){return this.$(a).append(this.get(b)||b),this},prependChild:function(a,b){return this.$(a).prepend(this.get(b)||b),this},remove:function(a){return this.$(f.array(arguments).join(",")).remove(),this},append:function(a){var b,c;for(b in a)if(a.hasOwnProperty(b))if(a[b].constructor===Array)for(c=0;a[b][c];c++)this.appendChild(b,a[b][c]);else this.appendChild(b,a[b]);return this},_scaleImage:function(a,b){if(a=a||this._controls.getActive()){var d,e=function(a){c(a.container).children(":first").css({top:Math.max(0,f.parseValue(a.image.style.top)),left:Math.max(0,f.parseValue(a.image.style.left)),width:f.parseValue(a.image.width),height:f.parseValue(a.image.height)})};return b=c.extend({width:this._stageWidth,height:this._stageHeight,crop:this._options.imageCrop,max:this._options.maxScaleRatio,min:this._options.minScaleRatio,margin:this._options.imageMargin,position:this._options.imagePosition,iframelimit:this._options.maxVideoSize},b),this._options.layerFollow&&!0!==this._options.imageCrop?"function"==typeof b.complete?(d=b.complete,b.complete=function(){d.call(a,a);e(a)}):b.complete=e:c(a.container).children(":first").css({top:0,left:0}),a.scale(b),this}},updateCarousel:function(){return this._carousel.update(),this},resize:function(a,b){"function"==typeof a&&(b=a,a=void 0);a=c.extend({width:0,height:0},a);var d=this,e=this.$("container");return c.each(a,function(b,c){c||(e[b]("auto"),a[b]=d._getWH()[b])}),c.each(a,function(a,b){e[a](b)}),this.rescale(b)},rescale:function(a,b,c){var e=this;"function"==typeof a&&(c=a,a=void 0);return function(){e._stageWidth=a||e.$("stage").width();e._stageHeight=b||e.$("stage").height();e._scaleImage();e._options.carousel&&e.updateCarousel();e.trigger(Galleria.RESCALE);"function"==typeof c&&c.call(e)}.call(e),this},refreshImage:function(){return this._scaleImage(),this._options.imagePan&&this.addPan(),this},show:function(a,b,c){if(!(3<this._queue.length||!1===a||!this._options.queue&&this._queue.stalled))if(a=Math.max(0,Math.min(parseInt(a,10),this.getDataLength()-1)),b="undefined"!=typeof b?!!b:a<this.getIndex(),!c&&Galleria.History)Galleria.History.set(a.toString());else return this._active=a,B.push.call(this._queue,{index:a,rewind:b}),this._queue.stalled||this._show(),this},_show:function(){var a=this,b=this._queue[0],d=this.getData(b.index);if(d){var e=d.iframe||(this.isFullscreen()&&"big"in d?d.big:d.image),g=this._controls.getActive(),l=this._controls.getNext(),h=l.isCached(e),j=this._thumbnails[b.index],n=function(){c(l.image).trigger("mouseup")},q;q=function(){k=!1;f.toggleQuality(l.image,a._options.imageQuality);a._layers[a._controls.active].innerHTML="";c(g.container).css({zIndex:0,opacity:0}).show();g.isIframe&&c(g.container).find("iframe").remove();a.$("container").toggleClass("iframe",!!d.iframe);c(l.container).css({zIndex:1,left:0,top:0}).show();a._controls.swap();a._options.imagePan&&a.addPan(l.image);(d.link||a._options.lightbox||a._options.clicknext)&&c(l.image).css({cursor:"pointer"}).bind("mouseup",function(b){"number"==typeof b.which&&1<b.which||(a._options.clicknext&&!Galleria.TOUCH?(a._options.pauseOnInteraction&&a.pause(),a.next()):d.link?a._options.popupLinks?m.open(d.link,"_blank"):m.location.href=d.link:a._options.lightbox&&a.openLightbox())});a._playCheck();a.trigger({type:Galleria.IMAGE,index:b.index,imageTarget:l.image,thumbTarget:j.image,galleriaData:d});B.shift.call(a._queue);a._queue.stalled=!1;a._queue.length&&a._show()};this._options.carousel&&this._options.carouselFollow&&this._carousel.follow(b.index);if(this._options.preload){var w,C,s=this.getNext(),u;try{for(C=this._options.preload;0<C;C--)w=new Galleria.Picture,u=a.getData(s),w.preload(this.isFullscreen()&&"big"in u?u.big:u.image),s=a.getNext(s)}catch(t){}}f.show(l.container);l.isIframe=!!d.iframe;c(a._thumbnails[b.index].container).addClass("active").siblings(".active").removeClass("active");a.trigger({type:Galleria.LOADSTART,cached:h,index:b.index,rewind:b.rewind,imageTarget:l.image,thumbTarget:j.image,galleriaData:d});a._queue.stalled=!0;l.load(e,function(e){var j=c(a._layers[1-a._controls.active]).html(d.layer||"").hide();a._scaleImage(e,{complete:function(e){"image"in g&&f.toggleQuality(g.image,!1);f.toggleQuality(e.image,!1);a.removePan();a.setInfo(b.index);a.setCounter(b.index);d.layer&&(j.show(),(d.link||a._options.lightbox||a._options.clicknext)&&j.css("cursor","pointer").unbind("mouseup").mouseup(n));var l=a._options.transition;c.each({initial:null===g.image,touch:Galleria.TOUCH,fullscreen:a.isFullscreen()},function(b,c){if(c&&void 0!==a._options[b+"Transition"])return l=a._options[b+"Transition"],!1});if(0==l in r)q();else{var m={prev:g.container,next:e.container,rewind:b.rewind,speed:a._options.transitionSpeed||400};k=!0;p.call(a,l,m,q)}a.trigger({type:Galleria.LOADFINISH,cached:h,index:b.index,rewind:b.rewind,imageTarget:e.image,thumbTarget:a._thumbnails[b.index].image,galleriaData:a.getData(b.index)})}})})}},getNext:function(a){return a="number"==typeof a?a:this.getIndex(),a===this.getDataLength()-1?0:a+1},getPrev:function(a){return a="number"==typeof a?a:this.getIndex(),0===a?this.getDataLength()-1:a-1},next:function(){return 1<this.getDataLength()&&this.show(this.getNext(),!1),this},prev:function(){return 1<this.getDataLength()&&this.show(this.getPrev(),!0),this},get:function(a){return a in this._dom?this._dom[a]:null},getData:function(a){return a in this._data?this._data[a]:this._data[this._active]},getDataLength:function(){return this._data.length},getIndex:function(){return"number"==typeof this._active?this._active:!1},getStageHeight:function(){return this._stageHeight},getStageWidth:function(){return this._stageWidth},getOptions:function(a){return"undefined"==typeof a?this._options:this._options[a]},setOptions:function(a,b){return"object"==typeof a?c.extend(this._options,a):this._options[a]=b,this},play:function(a){return this._playing=!0,this._playtime=a||this._playtime,this._playCheck(),this.trigger(Galleria.PLAY),this},pause:function(){return this._playing=!1,this.trigger(Galleria.PAUSE),this},playToggle:function(a){return this._playing?this.pause():this.play(a)},isPlaying:function(){return this._playing},isFullscreen:function(){return this._fullscreen.active},_playCheck:function(){var a=this,b=0,c=f.timestamp(),e="play"+this._id;if(this._playing){this.clearTimer(e);var g=function(){b=f.timestamp()-c;b>=a._playtime&&a._playing?(a.clearTimer(e),a.next()):a._playing&&(a.trigger({type:Galleria.PROGRESS,percent:Math.ceil(100*(b/a._playtime)),seconds:Math.floor(b/1E3),milliseconds:b}),a.addTimer(e,g,20))};a.addTimer(e,g,20)}},setPlaytime:function(a){return this._playtime=a,this},setIndex:function(a){return this._active=a,this},setCounter:function(a){"number"==typeof a?a++:"undefined"==typeof a&&(a=this.getIndex()+1);this.get("current").innerHTML=a;if(q){a=this.$("counter");var b=a.css("opacity");1===parseInt(b,10)?f.removeAlpha(a[0]):this.$("counter").css("opacity",b)}return this},setInfo:function(a){var b=this,d=this.getData(a);return c.each(["title","description"],function(a,c){var f=b.$("info-"+c);d[c]?f[d[c].length?"show":"hide"]().html(d[c]):f.empty().hide()}),this},hasInfo:function(a){var b=["title","description"],c;for(c=0;b[c];c++)if(this.getData(a)[b[c]])return!0;return!1},jQuery:function(a){var b=this,d=[];c.each(a.split(","),function(a,e){e=c.trim(e);b.get(e)&&d.push(e)});var e=c(b.get(d.shift()));return c.each(d,function(a,c){e=e.add(b.get(c))}),e},$:function(a){return this.jQuery.apply(this,f.array(arguments))}};c.each(T,function(a,b){var c=/_/.test(b)?b.replace(/_/g,""):b;Galleria[b.toUpperCase()]="galleria."+c});c.extend(Galleria,{IE9:9===q,IE8:8===q,IE7:7===q,IE6:6===q,IE:q,WEBKIT:/webkit/.test(D),CHROME:/chrome/.test(D),SAFARI:/safari/.test(D)&&!/chrome/.test(D),QUIRK:q&&n.compatMode&&"BackCompat"===n.compatMode,MAC:/mac/.test(navigator.platform.toLowerCase()),OPERA:!!m.opera,IPHONE:/iphone/.test(D),IPAD:/ipad/.test(D),ANDROID:/android/.test(D),TOUCH:"ontouchstart"in n});Galleria.addTheme=function(a){a.name||Galleria.raise("No theme name specified");"object"!=typeof a.defaults?a.defaults={}:a.defaults=ha(a.defaults);var b=!1,d;return"string"==typeof a.css?(c("link").each(function(c,f){d=RegExp(a.css);if(d.test(f.href))return b=!0,Y(a),!1}),b||c("script").each(function(c,g){d=RegExp("galleria\\."+a.name.toLowerCase()+"\\.");d.test(g.src)&&(b=g.src.replace(/[^\/]*$/,"")+a.css,m.setTimeout(function(){f.loadCSS(b,"galleria-theme",function(){Y(a)})},1))}),b||Galleria.raise("No theme CSS loaded")):Y(a),a};Galleria.loadTheme=function(a){if(!c("script").filter(function(){return c(this).attr("src")==a}).length){var b=!1,d;return c(m).load(function(){b||(d=m.setTimeout(function(){!b&&!Galleria.theme&&Galleria.raise("Galleria had problems loading theme at "+a+". Please check theme path or load manually.",!0)},2E4))}),Galleria.unloadTheme(),f.loadScript(a,function(){b=!0;m.clearTimeout(d)}),Galleria}};Galleria.unloadTheme=function(){return"object"==typeof Galleria.theme&&(c("script").each(function(a,b){RegExp("galleria\\."+Galleria.theme.name+"\\.").test(b.src)&&c(b).remove()}),Galleria.theme=void 0),Galleria};Galleria.get=function(a){if(F[a])return F[a];if("number"!=typeof a)return F;Galleria.raise("Gallery index "+a+" not found")};Galleria.configure=function(a,b){var d={};return"string"==typeof a&&b?(d[a]=b,a=d):c.extend(d,a),Galleria.configure.options=d,c.each(Galleria.get(),function(a,b){b.setOptions(d)}),Galleria};Galleria.configure.options={};Galleria.on=function(a,b){if(a){b=b||s;var d=a+b.toString().replace(/\s/g,"")+f.timestamp();return c.each(Galleria.get(),function(c,f){f._binds.push(d);f.bind(a,b)}),Galleria.on.binds.push({type:a,callback:b,hash:d}),Galleria}};Galleria.on.binds=[];Galleria.run=function(a,b){return c.isFunction(b)&&(b={extend:b}),c(a||"#galleria").galleria(b),Galleria};Galleria.addTransition=function(a,b){return r[a]=b,Galleria};Galleria.utils=f;Galleria.log=function(){var a=f.array(arguments);if(!("console"in m&&"log"in m.console))return m.alert(a.join("<br>"));try{return m.console.log.apply(m.console,a)}catch(b){c.each(a,function(){m.console.log(this)})}};Galleria.ready=function(a){return"function"!=typeof a?Galleria:(c.each(W,function(b,c){a.call(c,c._options)}),Galleria.ready.callbacks.push(a),Galleria)};Galleria.ready.callbacks=[];Galleria.raise=function(a,b){var d=b?"Fatal error":"Error",e={color:"#fff",position:"absolute",top:0,left:0,zIndex:1E5},f=function(a){var f='<div style="padding:4px;margin:0 0 2px;background:#'+(b?"811":"222")+';">'+(b?"<strong>"+d+": </strong>":"")+a+"</div>";c.each(F,function(){var a=this.$("errors"),b=this.$("target");a.length||(b.css("position","relative"),a=this.addElement("errors").appendChild("target","errors").$("errors").css(e));a.append(f)});F.length||c("<div>").css(c.extend(e,{position:"fixed"})).append(f).appendTo(v().body)};if(fa){if(f(a),b)throw Error(d+": "+a);}else b&&!ja&&(ja=!0,b=!1,f("Gallery could not load."))};Galleria.version=1.29;Galleria.requires=function(a,b){return b=b||"You need to upgrade Galleria to version "+a+" to use one or more components.",Galleria.version<a&&Galleria.raise(b,!0),Galleria};Galleria.Picture=function(a){this.id=a||null;this.image=null;this.container=f.create("galleria-image");c(this.container).css({overflow:"hidden",position:"relative"});this.original={width:0,height:0};this.isIframe=this.ready=!1};Galleria.Picture.prototype={cache:{},show:function(){f.show(this.image)},hide:function(){f.moveOut(this.image)},clear:function(){this.image=null},isCached:function(a){return!!this.cache[a]},preload:function(a){c(new Image).load(function(a,c){return function(){c[a]=a}}(a,this.cache)).attr("src",a)},load:function(a,b,d){"function"==typeof b&&(d=b,b=null);if(this.isIframe){var e="if"+(new Date).getTime();return this.image=c("<iframe>",{src:a,frameborder:0,id:e,allowfullscreen:!0,css:{visibility:"hidden"}})[0],c(this.container).find("iframe,img").remove(),this.container.appendChild(this.image),c("#"+e).load(function(a,b){return function(){m.setTimeout(function(){c(a.image).css("visibility","visible");"function"==typeof b&&b.call(a,a)},10)}}(this,d)),this.container}this.image=new Image;Galleria.IE8&&c(this.image).css("filter","inherit");var g=!1,l=!1,e=c(this.container),h=c(this.image),j,k=this,n=d;j=function(){var d=function(){c(this).unbind("load");k.original=b||{height:this.height,width:this.width};k.container.appendChild(this);k.cache[a]=a;"function"==typeof n&&m.setTimeout(function(){n.call(k,k)},1)};!this.width||!this.height?m.setTimeout(function(a){return function(){a.width&&a.height?d.call(a):l?Galleria.raise("Could not extract width/height from image: "+a.src+". Traced measures: width:"+a.width+"px, height: "+a.height+"px."):(c(new Image).load(j).attr("src",a.src),l=!0)}}(this),2):d.call(this)};return e.find("iframe,img").remove(),h.css("display","block"),f.hide(this.image),c.each(["minWidth","minHeight","maxWidth","maxHeight"],function(a,b){h.css(b,/min/.test(b)?"0":"none")}),h.load(j).error(function(){g?S?c(this).attr("src",S):Galleria.raise("Image not found: "+a):(g=!0,m.setTimeout(function(a,b){return function(){a.attr("src",b+"?"+f.timestamp())}}(c(this),a),50))}).attr("src",a),this.container},scale:function(a){var b=this;a=c.extend({width:0,height:0,min:void 0,max:void 0,margin:0,complete:s,position:"center",crop:!1,canvas:!1,iframelimit:void 0},a);if(this.isIframe){var d=a.width,e=a.height,g,k;if(a.iframelimit){var h=Math.min(a.iframelimit/d,a.iframelimit/e);1>h?(g=d*h,k=e*h,c(this.image).css({top:e/2-k/2,left:d/2-g/2,position:"absolute"})):c(this.image).css({top:0,left:0})}c(this.image).width(g||d).height(k||e).removeAttr("width").removeAttr("height");c(this.container).width(d).height(e);a.complete.call(b,b);try{this.image.contentWindow&&c(this.image.contentWindow).trigger("resize")}catch(j){}return this.container}if(!this.image)return this.container;var m,n,p=c(b.container),q;return f.wait({until:function(){return m=a.width||p.width()||f.parseValue(p.css("width")),n=a.height||p.height()||f.parseValue(p.css("height")),m&&n},success:function(){var d=(m-2*a.margin)/b.original.width,e=(n-2*a.margin)/b.original.height,g=Math.min(d,e),h=Math.max(d,e),j={"true":h,width:d,height:e,"false":g,landscape:b.original.width>b.original.height?h:g,portrait:b.original.width<b.original.height?h:g}[a.crop.toString()],g="";a.max&&(j=Math.min(a.max,j));a.min&&(j=Math.max(a.min,j));c.each(["width","height"],function(a,d){c(b.image)[d](b[d]=b.image[d]=Math.round(b.original[d]*j))});c(b.container).width(m).height(n);if(a.canvas&&z){z.elem.width=b.width;z.elem.height=b.height;g=b.image.src+":"+b.width+"x"+b.height;d=b.image;if(!(e=z.cache[g])){z.context.drawImage(b.image,0,0,b.original.width*j,b.original.height*j);try{e=(q=z.elem.toDataURL(),z.length+=q.length,z.cache[g]=q,q)}catch(k){e=b.image.src}}d.src=e}var l={},p={},d=function(a,d,e){var g=0;/\%/.test(a)?(a=parseInt(a,10)/100,d=b.image[d]||c(b.image)[d](),g=Math.ceil(-1*d*a+e*a)):g=f.parseValue(a);return g},r={top:{top:0},left:{left:0},right:{left:"100%"},bottom:{top:"100%"}};c.each(a.position.toLowerCase().split(" "),function(a,b){"center"===b&&(b="50%");l[a?"top":"left"]=b});c.each(l,function(a,b){r.hasOwnProperty(b)&&c.extend(p,r[b])});l=l.top?c.extend(l,p):p;l=c.extend({top:"50%",left:"50%"},l);c(b.image).css({position:"absolute",top:d(l.top,"height",n),left:d(l.left,"width",m)});b.show();b.ready=!0;a.complete.call(b,b)},error:function(){Galleria.raise("Could not scale image: "+b.image.src)},timeout:1E3}),this}};c.extend(c.easing,{galleria:function(a,b,c,e,f){return 1>(b/=f/2)?e/2*b*b*b+c:e/2*((b-=2)*b*b+2)+c},galleriaIn:function(a,b,c,e,f){return e*(b/=f)*b+c},galleriaOut:function(a,b,c,e,f){return-e*(b/=f)*(b-2)+c}});c.fn.galleria=function(a){var b=this.selector;return c(this).length?this.each(function(){c.data(this,"galleria")&&(c.data(this,"galleria").destroy(),c(this).find("*").hide());c.data(this,"galleria",(new Galleria).init(this,a))}):(c(function(){c(b).length?c(b).galleria(a):Galleria.utils.wait({until:function(){return c(b).length},success:function(){c(b).galleria(a)},error:function(){Galleria.raise('Init failed: Galleria could not find the element "'+b+'".')},timeout:5E3})}),this)}})(jQuery);(function(c){Galleria.addTheme({name:"AGClassic",author:"Abtin",css:"AGStylesGallery.min.css",defaults:{transition:"slide",thumbCrop:"height",_toggleInfo:!0},init:function(k){Galleria.requires(1.28,"This version of Classic theme requires Galleria 1.2.8 or later");this.addElement("info-link","info-close");this.append({info:["info-link","info-close"]});var p=this.$("info-link,info-close,info-text"),r=Galleria.TOUCH,m=r?"touchstart":"click";this.$("loader,counter").show().css("opacity",0.4);r||(this.addIdleState(this.get("image-nav-left"),{left:-50}),this.addIdleState(this.get("image-nav-right"),{right:-50}),this.addIdleState(this.get("counter"),{opacity:0}));!0===k._toggleInfo?p.bind(m,function(){p.toggle()}):(p.show(),this.$("info-link, info-close").hide());this.bind("thumbnail",function(k){r?c(k.thumbTarget).css("opacity",this.getIndex()?1:0.6):(c(k.thumbTarget).css("opacity",0.6).parent().hover(function(){c(this).not(".active").children().stop().fadeTo(100,1)},function(){c(this).not(".active").children().stop().fadeTo(400,0.6)}),k.index===this.getIndex()&&c(k.thumbTarget).css("opacity",1))});this.bind("loadstart",function(k){k.cached||this.$("loader").show().fadeTo(200,0.4);this.$("info").toggle(this.hasInfo());c(k.thumbTarget).css("opacity",1).parent().siblings().children().css("opacity",0.6)});this.bind("loadfinish",function(){this.$("loader").fadeOut(200)})}})})(jQuery);var speedBps=0,speedKbps=0,speedMbps=0;function getConnectionSpeed(c,k,p,r){var m,n,J=new Image;m=(new Date).getTime();J.onload=function(){n=(new Date).getTime();getResults(m,n,k,p,r)};J.src=c+"?n="+Math.random()}function getResults(c,k,p,r,m){speedBps=(8*p/((k-c)/1E3)).toFixed(2);speedKbps=(speedBps/1024).toFixed(2);speedMbps=(speedKbps/1024).toFixed(2);m?r.apply(this,m):r.apply(this)}function showResults(){alert("Your connection speed is: \n"+speedBps+" bps\n"+speedKbps+" kbps\n"+speedMbps+" Mbps\n")};var gallery,galleryHeight=515,galleryPagePadding=20,categories="All;2D Art;3D Art;Audio;Code;Design;Games;Web".split(";");optionsObj={};optionsObj={width:720,height:515,popupLinks:!0,showInfo:!0,_toggleInfo:!1,transition:"none",dataSource:"",responsive:!0,trueFullscreen:!0,extend:function(){gallery=Galleria.get(0);setTimeout(function(){galleryOptions();gallery.trigger(Galleria.IMAGE)},1E3)}};var mainContentGalleryPageHeight,mobileGamesWarningMsg="<br /><br />*Note: The games are only compatible with Windows and Mac PCs.&nbsp;&nbsp;Clicking on the the screenshot above will not start the game on the current device.",mobileFlashWarningMsg="<br /><br />*Note: Flash videos are only compatible with Windows and Mac PCs.&nbsp;&nbsp;Clicking on the the screenshot above will not start the video on the current device.",flashDVDWarningMsg="<br /><div style='font-size:20px;color:#F00'><u>*Pop-ups must be allowed to view the video.&nbsp;&nbsp;You may have to refresh the page after enabling pop-ups.&nbsp;&nbsp;After clicking on the gallery image the film will show up in a separate window.";isChrome&&(flashDVDWarningMsg+="<br />*If you are experiencing issues with the DVD in fullscreen mode:<br /><div style='font-size:18px;text-align:left'>1. Type 'chrome://plugins' in the address bar.<br />2. Click the '+' sign next to Details on the top right.<br />3. Under the 'Adobe Flash Player' category, search for the plugin with the Location that ends in '... PepperFlashpepflashplayer.dll' and disable it.</div>");var flashDVDWarningMsg=flashDVDWarningMsg+"<u></div>",javaWarningMsg="<br /><div style='font-size:20px;color:#F00'><u>*The Java ";"Mac"==currentPlatform&&(javaWarningMsg+="SE 6 (default Apple-provided version) ");var javaWarningMsg=javaWarningMsg+"plugin must be installed and enabled on your browser in order to play. You may have to click inside the game window for the controls to respond.<u></div>",galleriaIconPositionsNormalBottom="10px",galleriaIconPositionsVideoBottom="40px",galleriaIconPositionsCodeBottom="22px",galleryIconXNormal=["10px","52px","10px"],galleryIconXOffsets=["40px","82px","40px"],changingFullscreenMode=!1,lastGalleryIndex=0,exitingFullscreen=!1,noTrueFullscreenSupport=!1,currentCategory,currentMediaType,minSpeedForHighQ=0.65;function setupGallery(){$.ajax({url:"work/queryDatabase",type:"GET",dataType:"json",data:{currentDisplay:"0"},success:function(c){optionsObj.dataSource=c;c=document.documentElement;!c.requestFullscreen&&(!c.mozRequestFullScreen&&!c.webkitRequestFullScreen)&&(noTrueFullscreenSupport=!0,optionsObj.trueFullscreen=!1);$("#gallery").galleria(optionsObj);$("#gallery").show(function(){$(".galleria-stage").append('<div id="fullscreen" class="galleria-fullscreen-toggle"><a><img src="images/fullscreenButtonSmall.png" title="Fullscreen Toggle"></a></div>');$(".galleria-stage").append('<div id="popout" class="galleria-popout-image"><a><img src="images/popoutButtonSmall.png" title="Popout Image"></a></div>');$(".galleria-container").append('<div class="grid_18" style="height:50px;"><div class="galleria-categories-container"><div class="grid_1"><br></div>');for(var c=0;c<categories.length;c++)$(".galleria-categories-container").append('<a class="grid_2 categoryButton" id="'+c+'">'+categories[c]+"</a>");$(".galleria-container").append('<div class="grid_1"><br></div></div></div>');$(".categoryButton").on("click",function(){updateGallery($(this).attr("id"))});document.getElementById("gallery").oncontextmenu=new Function("return false")})}})}function galleryOptions(){gallery.attachKeyboard({left:gallery.prev,right:gallery.next,up:function(){Galleria.log("up pressed")},70:function(){gallery.toggleFullscreen()}});gallery.bind(Galleria.LOADFINISH,function(){exitingFullscreen&&(gallery.show(lastGalleryIndex),exitingFullscreen=!1,setTimeout(function(){$(".galleria-image").css("visibility","visible")},500))});gallery.bind(Galleria.FULLSCREEN_ENTER,function(){gallery.show(gallery.getIndex());optionsObj.height=0;optionsObj.width=0;$(".galleria-info").css({opacity:"0.0",top:"50px"});$(".galleria-fullscreen-toggle").css("opacity","0.5");$(".galleria-container").css("margin","auto");$(".galleria-categories-container").css("left",$("#blankLeft").offset().left+$("#blankLeft").outerWidth());gallery.bind(Galleria.RESCALE,function(){$(".galleria-categories-container").css("left",$("#blankLeft").offset().left+$("#blankLeft").outerWidth())})});gallery.bind(Galleria.FULLSCREEN_EXIT,function(){changingFullscreenMode||(optionsObj.width=740,optionsObj.height=0.6959459459459459,$(".galleria-image").unbind("mouseover"),$(".galleria-image").unbind("mouseout"),$(".galleria-info").css({top:"",opacity:""}),$(".galleria-fullscreen-toggle").css("opacity","0.5"),$(".galleria-container").css("margin",""),gallery.unbind(Galleria.RESCALE),$(".galleria-categories-container").css("left",""),!noTrueFullscreenSupport&&!changingFullscreenMode&&(optionsObj.trueFullscreen=!0),lastGalleryIndex=gallery.getIndex(),gallery.setOptions(optionsObj),exitingFullscreen=!0,$(".galleria-image").css("visibility","hidden"),gallery.load())});gallery.bind(Galleria.IDLE_ENTER,function(){$("#fullscreen").hide();$("#popout").hide()});gallery.bind(Galleria.IDLE_EXIT,function(){$("#fullscreen").show();$("#popout").show()});gallery.bind(Galleria.IMAGE,function(){currentCategory=gallery.getData().category;currentMediaType=gallery.getData().mediaType;gallery.isFullscreen()||(mainContentGalleryPageHeight=galleryHeight+$(".galleria-info").outerHeight()+2*galleryPagePadding,adjustMainContentHeight());gallery.isFullscreen()&&($(".galleria-image").unbind("mouseover"),$(".galleria-image").unbind("mouseout"),$(".galleria-image").mouseover(function(){$(".galleria-info").css("opacity","1.0")}),$(".galleria-image").mouseout(function(){$(".galleria-info").css("opacity","0.0")}));"art2D"==currentCategory?(adjustIconPositionsBottom(galleriaIconPositionsVideoBottom),adjustIconPositionsX(galleryIconXNormal)):"art3D"==currentCategory||"audio"==currentCategory?(adjustIconPositionsBottom(galleriaIconPositionsVideoBottom),adjustIconPositionsX(galleryIconXNormal)):"code"==currentCategory?(adjustIconPositionsBottom(galleriaIconPositionsNormalBottom),adjustIconPositionsX(galleryIconXOffsets),adjustIconPositionsBottom(galleriaIconPositionsCodeBottom)):(adjustIconPositionsBottom(galleriaIconPositionsNormalBottom),adjustIconPositionsX(galleryIconXNormal));$(".galleria-counter").css("opacity","0.5");gallery.$("images").unbind("click");"games"==currentCategory?handleImageLoadGames():"art2D"==currentCategory?getConnectionSpeed("http://www.abtingramian.com/images/connection_test.jpg",99077,handleImageLoadArt2D,null):"art3D"==currentCategory?getConnectionSpeed("http://www.abtingramian.com/images/connection_test.jpg",99077,handleImageLoadArt3D,null):"audio"==currentCategory?"Audio"!=currentMediaType?getConnectionSpeed("http://www.abtingramian.com/images/connection_test.jpg",99077,handleImageLoadAudio,null):handleImageLoadAudio():"code"==currentCategory?getCodeSrc():"web"==currentCategory&&$(gallery.getActiveImage()).css("pointer-events","auto")});$(".galleria-counter").mouseover(function(){$(".galleria-counter").css("opacity","1.0")});$(".galleria-counter").mouseout(function(){$(".galleria-counter").css("opacity","0.5")});$("#fullscreen").click(function(){"code"==currentCategory&&$("#codeSrcDiv").css("opacity",0);gallery.toggleFullscreen()});$("#fullscreen").mouseover(function(){$(".galleria-fullscreen-toggle").css("opacity","1.0")});$("#fullscreen").mouseout(function(){$(".galleria-fullscreen-toggle").css("opacity","0.5")});$("#popout").click(function(){gallery.openLightbox()});$("#popout").mouseover(function(){$(".galleria-popout-image").css("opacity","1.0")});$("#popout").mouseout(function(){$(".galleria-popout-image").css("opacity","0.5")})}function handleImageLoadArt2D(){$("#art2DDiv").css("visibility","hidden");"Flash"==currentMediaType&&!isMobileDevice?gallery.$("images").bind("click",function(){gallery.$("images").unbind("click");getFlashSrc("#art2DDiv",gallery.getData().mediaPath)}):0!=gallery.getData().backup&&(adjustIconPositionsBottom(galleriaIconPositionsVideoBottom),adjustIconPositionsX(galleryIconXNormal),$("#art2DDiv").css("visibility","hidden"),gallery.$("images").bind("click",function(){gallery.$("images").unbind("click");getVideoSrc("#art2DDiv",gallery.getData().backup,"0")}))}function handleImageLoadArt3D(){$("#art3DDiv").css("visibility","hidden");"Video"==currentMediaType&&gallery.$("images").bind("click",function(){gallery.$("images").unbind("click");isMobileDevice?getVideoSrc("#art3DDiv",gallery.getData().mediaPath,"0"):getVideoSrc("#art3DDiv",gallery.getData().mediaPath,gallery.getData().loop)})}function handleImageLoadAudio(){$("#audioDiv").css("visibility","hidden");"Video"==currentMediaType?gallery.$("images").bind("click",function(){gallery.$("images").unbind("click");getVideoSrc("#audioDiv",gallery.getData().mediaPath,gallery.getData().loop)}):"Audio"==currentMediaType?gallery.$("images").bind("click",function(){gallery.$("images").unbind("click");getAudioSrc("#audioDiv",gallery.getData().mediaPath)}):"FlashDVD"==currentMediaType&&(!isMobileDevice&&speedMbps>minSpeedForHighQ?($(".galleria-info-description").html($(".galleria-info-description").html()+flashDVDWarningMsg),mainContentGalleryPageHeight=galleryHeight+$(".galleria-info").outerHeight()+2*galleryPagePadding,adjustMainContentHeight(),gallery.$("images").bind("click",function(){getFlashDVDSrc()})):0!=gallery.getData().backup&&(adjustIconPositionsBottom(galleriaIconPositionsVideoBottom),adjustIconPositionsX(galleryIconXNormal),$("#audioDiv").css("visibility","hidden"),gallery.$("images").bind("click",function(){gallery.$("images").unbind("click");getVideoSrc("#audioDiv",gallery.getData().backup,gallery.getData().loop)})))}function handleImageLoadGames(){isMobileDevice&&0==gallery.getData().backup?($(".galleria-info-description").html($(".galleria-info-description").html()+mobileGamesWarningMsg),mainContentGalleryPageHeight=galleryHeight+$(".galleria-info").outerHeight()+2*galleryPagePadding,adjustMainContentHeight()):isMobileDevice&&0!=gallery.getData().backup?(adjustIconPositionsBottom(galleriaIconPositionsVideoBottom),adjustIconPositionsX(galleryIconXNormal),$("#gameDiv").css("visibility","hidden"),gallery.$("images").bind("click",function(){gallery.$("images").unbind("click");getVideoSrc("#gameDiv",gallery.getData().backup,gallery.getData().loop)})):!noTrueFullscreenSupport&&gallery.isFullscreen()&&optionsObj.trueFullscreen?gallery.$("images").bind("click",function(){!noTrueFullscreenSupport&&(gallery.isFullscreen()&&optionsObj.trueFullscreen)&&(changingFullscreenMode=!0,gallery.toggleFullscreen(),optionsObj.trueFullscreen=!1,gallery.setOptions(optionsObj),$("#navigationBar").css("opacity",0),$("#mainContent").css("opacity",0),setTimeout(function(){changingFullscreenMode=!1;gallery.toggleFullscreen();$("#mainContent").css("opacity",1);$("#navigationBar").css("opacity",1)},1500))}):"UDK"==currentMediaType?-1!=navigator.platform.indexOf("Win")?$("#gameLink").attr("href",gallery.getData().mediaPath+"-WIN.zip"):-1!=navigator.platform.indexOf("Mac")&&$("#gameLink").attr("href",gallery.getData().mediaPath+"-MAC.zip"):"Flash"==currentMediaType?gallery.$("images").bind("click",function(){gallery.isFullscreen()&&($(".galleria-info").css("opacity","0.0"),$(".galleria-image").unbind("mouseover"),$(".galleria-image").unbind("mouseout"));getFlashSrc("#gameDiv",gallery.getData().mediaPath)}):("PONGRE"==gallery.getData().title&&($(".galleria-info-description").html($(".galleria-info-description").html()+javaWarningMsg),mainContentGalleryPageHeight=galleryHeight+$(".galleria-info").outerHeight()+2*galleryPagePadding,adjustMainContentHeight()),gallery.$("images").bind("click",function(){gallery.$("images").unbind("click");gallery.isFullscreen()&&($(".galleria-info").css("opacity","0.0"),$(".galleria-image").unbind("mouseover"),$(".galleria-image").unbind("mouseout"));if("IFrame"==currentMediaType)$("#gameDiv").html(gallery.getData().iframeCode),$("#gameDiv").css("visibility","visible"),gallery.getActiveImage().style.display="none";else if("Panda3D"==currentMediaType){var c=!1;navigator.userAgent.match(/msie/i)?($("#gameDiv").html(gallery.getData().iframeCode),$("#gameDiv").css("visibility","visible"),gallery.getActiveImage().style.display="none"):(detectPanda3D()?c=!0:$("#gameDiv").css("position","relative"),getGameSrc("#gameDiv",gallery.getData().mediaPath,c,"both",0,0))}else"Ogre"==currentMediaType&&("Win"==currentPlatform?getGameSrc("#gameDiv",gallery.getData().mediaPath,c,"Win",$("#gameDiv").width(),$("#gameDiv").height()):"Mac"==currentPlatform&&(!(gallery.isFullscreen()&&!0==optionsObj.trueFullscreen)&&!changingFullscreenMode)&&getGameSrc("#gameDiv",gallery.getData().mediaPath,c,"Mac",$("#gameDiv").width(),$("#gameDiv").height()))}))}function updateGallery(c){$(".galleria-info").css("opacity","0.0");$.ajax({url:"work/queryDatabase",type:"GET",dataType:"json",data:{currentDisplay:c},success:function(c){optionsObj.dataSource=c;gallery.setOptions(optionsObj);gallery.load();gallery.isFullscreen()&&noTrueFullscreenSupport&&setTimeout(function(){$(".galleria-container").css({width:"100%",height:"100%"})},1E3);$(".galleria-info").css("opacity","1.0")}})}function getVideoSrc(c,k,p){$.ajax({url:"work/getVideoSrc",type:"GET",dataType:"html",data:{src:k,speed:speedMbps,minHiQSpeed:minSpeedForHighQ},success:function(k){$(c).html(k);createVideoPlayer(parseInt(p),c);setTimeout(function(){$(c).css("visibility","visible");gallery.getActiveImage().style.display="none"},500)}})}function getAudioSrc(c,k){$.ajax({url:"work/getAudioSrc",type:"GET",dataType:"html",data:{src:k,mediaType:currentMediaType},success:function(k){$(c).html(k);createAudioPlayer();setTimeout(function(){$(c).css("visibility","visible");gallery.getActiveImage().style.display="none"},500)}})}function getFlashSrc(c,k){$.ajax({url:"work/getFlashSrc",type:"GET",dataType:"html",data:{src:k},success:function(k){$(c).html(k);setTimeout(function(){$(c).css("visibility","visible");gallery.getActiveImage().style.display="none"},500)}})}function getGameSrc(c,k,p,r,m,n){$.ajax({url:"work/getGameSrc",type:"GET",dataType:"html",data:{src:k,mediaType:currentMediaType,hasPlugin:p,platform:r,width:m,height:n},success:function(c){$("#gameDiv").html(c);setTimeout(function(){$("#gameDiv").css("visibility","visible");gallery.getActiveImage().style.display="none"},1E3)}})}function getCodeSrc(){$.ajax({url:"work/getCodeSrc",type:"GET",dataType:"html",data:{src:gallery.getData().mediaPath},success:function(c){$("#codeDiv").html(c);prettyPrint();$("#codeSrcDiv").css("width",document.getElementById("codeDiv").scrollWidth);gallery.getActiveImage().style.display="none";setTimeout(function(){$("#codeSrcDiv").css("opacity",1)},500)}})}function getFlashDVDSrc(){$.ajax({url:gallery.getData().mediaPath+".html",type:"GET",dataType:"html",success:function(){var c=window.open("","","width=1280,height=720,directories=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no");c.innerWidth=1280;c.innerHeight=720;xpos=screen.width/2-c.outerWidth/2;ypos=screen.height/2-c.outerHeight/2;c.moveTo(xpos,ypos);var k;k="<html>"+("<head><title>"+gallery.getData().title+"</title></head>");k+="<style type='text/css'>#Background_horizon{text-align: center;position: absolute;top: 50%;left: 0px;width: 100%;height: 1px;overflow: visible;display: block;z-index: 1;visibility: visible;}";k+="#Background_div {width: 1280px;height: 720px;margin-left: -640px;position: absolute;top: -360px;left: 50%;visibility: visible;}";k+="</style>";k+="<body bgcolor='#000000'>";k+="<div id='Background_horizon'><div id='Background_div'>";k+=gallery.getData().iframeCode;k+="</div></div>";k+="</body>";k+="</html>";c.document.write(k)}})}function adjustIconPositionsBottom(c){$(".galleria-counter").css("bottom",c);$(".galleria-popout-image").css("bottom",c);$(".galleria-fullscreen-toggle").css("bottom",c)}function adjustIconPositionsX(c){$(".galleria-counter").css("left",c[0]);$(".galleria-popout-image").css("right",c[1]);$(".galleria-fullscreen-toggle").css("right",c[2])};